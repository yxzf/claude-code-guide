# Model Context Protocol (MCP) å®Œæ•´æŒ‡å—

![MCPä¸»é¢˜å›¾ç‰‡](images/mcp1.jpg)

## ç›®å½•

- [1. MCP æ ¸å¿ƒæ¦‚å¿µ](#1-mcp-æ ¸å¿ƒæ¦‚å¿µ)
  - [1.1 ä»€ä¹ˆæ˜¯ MCPï¼Ÿ](#11-ä»€ä¹ˆæ˜¯-mcp)
  - [1.2 ä¸ºä»€ä¹ˆéœ€è¦MCPï¼Ÿ](#12-ä¸ºä»€ä¹ˆéœ€è¦mcp)
  - [1.3 MCP vs Function Call](#13-mcp-vs-function-call)
- [2. MCP æ¶æ„è®¾è®¡](#2-mcp-æ¶æ„è®¾è®¡)
  - [2.1 åŒå±‚æ¶æ„ï¼šåè®®ä¸ä¼ è¾“åˆ†ç¦»](#21-åŒå±‚æ¶æ„åè®®ä¸ä¼ è¾“åˆ†ç¦»)
  - [2.2 MCPæ¶æ„åˆ†å±‚](#22-mcpæ¶æ„åˆ†å±‚)
  - [2.3 æ ¸å¿ƒåŸè¯­æ¦‚è¿°](#23-æ ¸å¿ƒåŸè¯­æ¦‚è¿°)
- [3. MCP æŠ€æœ¯æ·±å…¥](#3-mcp-æŠ€æœ¯æ·±å…¥)
  - [3.1 æœåŠ¡å™¨åŸè¯­ï¼ˆServer Primitivesï¼‰](#31-æœåŠ¡å™¨åŸè¯­server-primitives)
  - [3.2 å®¢æˆ·ç«¯åŸè¯­ï¼ˆClient Primitivesï¼‰](#32-å®¢æˆ·ç«¯åŸè¯­client-primitives)
  - [3.3 AIå·¥å…·é€‰æ‹©æœºåˆ¶æ·±åº¦è§£æ](#33-aiå·¥å…·é€‰æ‹©æœºåˆ¶æ·±åº¦è§£æ)
- [4. å¼€å‘å®æˆ˜æŒ‡å— (åŠ¨æ‰‹å®è·µ)](#4-å¼€å‘å®æˆ˜æŒ‡å—-åŠ¨æ‰‹å®è·µ)
  - [4.1 5åˆ†é’Ÿåˆ›å»ºç¬¬ä¸€ä¸ªMCPå·¥å…·](#41-5åˆ†é’Ÿåˆ›å»ºç¬¬ä¸€ä¸ªmcpå·¥å…·)
  - [4.2 å®Œæ•´å®æˆ˜æ¡ˆä¾‹ï¼šæ¡Œé¢æ–‡æ¡£ç®¡ç†å™¨](#42-å®Œæ•´å®æˆ˜æ¡ˆä¾‹æ¡Œé¢æ–‡æ¡£ç®¡ç†å™¨)
- [5. MCP å®‰è£…é…ç½®æŒ‡å—](#5-mcp-å®‰è£…é…ç½®æŒ‡å—)
  - [5.1 claude mcp å‘½ä»¤æ¦‚è¿°](#51-claude-mcp-å‘½ä»¤æ¦‚è¿°)
  - [5.2 é…ç½®ç®¡ç†åŸºç¡€](#52-é…ç½®ç®¡ç†åŸºç¡€)
  - [5.3 å®‰è£…æ–¹å¼ä¸€ï¼šClaude Desktopå¯¼å…¥](#53-å®‰è£…æ–¹å¼ä¸€claude-desktopå¯¼å…¥)
  - [5.4 å®‰è£…æ–¹å¼äºŒï¼šæ‰‹åŠ¨é…ç½®](#54-å®‰è£…æ–¹å¼äºŒæ‰‹åŠ¨é…ç½®)
  - [5.5 å®‰è£…æ–¹å¼ä¸‰ï¼šå¼€å‘æ¨¡å¼](#55-å®‰è£…æ–¹å¼ä¸‰å¼€å‘æ¨¡å¼)
- [6. MCP ç”Ÿæ€ç³»ç»Ÿ](#6-mcp-ç”Ÿæ€ç³»ç»Ÿ)
  - [6.1 å®˜æ–¹å·¥å…·é›†](#61-å®˜æ–¹å·¥å…·é›†)
  - [6.2 ç¤¾åŒºå·¥å…·æ¨è](#62-ç¤¾åŒºå·¥å…·æ¨è)
  - [6.3 é€‰æ‹©å’Œè¯„ä¼°æŒ‡å—](#63-é€‰æ‹©å’Œè¯„ä¼°æŒ‡å—)

---

## 1. MCP æ ¸å¿ƒæ¦‚å¿µ

### 1.1 ä»€ä¹ˆæ˜¯ MCPï¼Ÿ

**Model Context Protocol (MCP)** æ˜¯ç”± Anthropic äº 2024å¹´11æœˆ25æ—¥ å‘å¸ƒçš„å¼€æ”¾åè®®ï¼Œä¸“é—¨ç”¨äºæ ‡å‡†åŒ– AI åº”ç”¨ç¨‹åºä¸å¤–éƒ¨æ•°æ®æºå’Œå·¥å…·ä¹‹é—´çš„äº¤äº’æ–¹å¼ã€‚

### MCP æ ¸å¿ƒæ¶æ„

MCP é‡‡ç”¨**å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„è®¾è®¡**ï¼ŒAIåº”ç”¨é€šè¿‡MCPå®¢æˆ·ç«¯ä¸å¤šä¸ªMCPæœåŠ¡å™¨å»ºç«‹ä¸€å¯¹ä¸€è¿æ¥ï¼š

<img src="images/mcp_official_architecture.png" alt="MCPæ ¸å¿ƒæ¶æ„å›¾" width="500">

#### æ¶æ„å‚ä¸è€…ï¼ˆParticipantsï¼‰

**MCP Hostï¼ˆAIåº”ç”¨ï¼‰**ï¼š
- **å®šä¹‰**ï¼šåè°ƒå’Œç®¡ç†ä¸€ä¸ªæˆ–å¤šä¸ªMCPå®¢æˆ·ç«¯çš„AIåº”ç”¨
- **ç¤ºä¾‹**ï¼šClaude Codeã€Claude Desktopã€Visual Studio Code
- **èŒè´£**ï¼šåˆ›å»ºå®¢æˆ·ç«¯å®ä¾‹ã€åè°ƒå¤šæœåŠ¡å™¨é€šä¿¡ã€ç®¡ç†ç”Ÿå‘½å‘¨æœŸ

**MCP Clientï¼ˆå®¢æˆ·ç«¯ï¼‰**ï¼š
- **å®šä¹‰**ï¼šç»´æŠ¤ä¸MCPæœåŠ¡å™¨è¿æ¥å¹¶è·å–ä¸Šä¸‹æ–‡çš„ç»„ä»¶
- **ç‰¹ç‚¹**ï¼šä¸MCPæœåŠ¡å™¨ä¿æŒä¸“ç”¨çš„ä¸€å¯¹ä¸€è¿æ¥
- **èŒè´£**ï¼šåè®®é€šä¿¡ã€æ¶ˆæ¯ä¼ é€’ã€çŠ¶æ€ç®¡ç†

**MCP Serverï¼ˆæœåŠ¡å™¨ï¼‰**ï¼š
- **å®šä¹‰**ï¼šå‘MCPå®¢æˆ·ç«¯æä¾›ä¸Šä¸‹æ–‡çš„ç¨‹åº
- **ç±»å‹**ï¼šæœ¬åœ°æœåŠ¡å™¨ï¼ˆSTDIOï¼‰ã€è¿œç¨‹æœåŠ¡å™¨ï¼ˆHTTP/SSEï¼‰
- **ç¤ºä¾‹**ï¼šSentryæœåŠ¡å™¨ã€æ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨ã€æ•°æ®åº“æœåŠ¡å™¨


#### æ ¸å¿ƒç±»æ¯”ï¼šAI ä¸–ç•Œçš„ USB-C
å°±åƒ USB-C ä¸ºå„ç§è®¾å¤‡æä¾›äº†ç»Ÿä¸€çš„è¿æ¥æ ‡å‡†ï¼ŒMCP ä¸º AI æ¨¡å‹ä¸å¤–éƒ¨èµ„æºæä¾›äº†ç»Ÿä¸€çš„äº¤äº’åè®®ã€‚

![MCPå¯¹æ¯”å›¾](images/mcp2.jpg)

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦MCPï¼Ÿ

#### Prompt Engineering å‘å±•çš„å¿…ç„¶äº§ç‰©

MCPçš„å‡ºç°æ˜¯ **Prompt Engineering å‘å±•çš„è‡ªç„¶ç»“æœ**ã€‚æ›´ç»“æ„åŒ–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å¯¹æ¨¡å‹æ€§èƒ½æå‡æ˜¯æ˜¾è‘—çš„ï¼š

```
å‘å±•é˜¶æ®µå¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰‹å·¥Promptæ—¶ä»£                               â”‚
â”‚ â”œâ”€ äººå·¥ä»æ•°æ®åº“ç­›é€‰ä¿¡æ¯                      â”‚
â”‚ â”œâ”€ æ‰‹åŠ¨å¤åˆ¶ç²˜è´´åˆ°promptä¸­                    â”‚
â”‚ â””â”€ é—®é¢˜å¤æ‚åº¦â†‘ = æ‰‹å·¥æˆæœ¬â†‘â†‘                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Function Callæ—¶ä»£                           â”‚
â”‚ â”œâ”€ é¢„å®šä¹‰å‡½æ•°è·å–æ•°æ®                        â”‚
â”‚ â”œâ”€ è‡ªåŠ¨åŒ–æ°´å¹³æ˜¾è‘—æå‡                        â”‚
â”‚ â””â”€ ä½†å¹³å°ä¾èµ–æ€§å¼ºï¼Œå…¼å®¹æ€§å·®                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MCPç»Ÿä¸€åè®®æ—¶ä»£                             â”‚
â”‚ â”œâ”€ æ ‡å‡†åŒ–å·¥å…·è°ƒç”¨æ¥å£                        â”‚
â”‚ â”œâ”€ è·¨å¹³å°å…¼å®¹ï¼Œç”Ÿæ€å…±äº«                      â”‚
â”‚ â””â”€ æ•°æ®å®‰å…¨ï¼Œæœ¬åœ°å¤„ç†                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Function Call çš„æ ¹æœ¬å±€é™æ€§

**å¹³å°ä¾èµ–æ€§é—®é¢˜**ï¼š
```python
# OpenAI æ–¹å¼
functions=[{
    "name": "get_weather", 
    "parameters": {"type": "object", "properties": {...}}
}]

# Google æ–¹å¼  
tools=[vertexai.generative_models.Tool(
    function_declarations=[...]
)]

# åˆ‡æ¢æ¨¡å‹ = é‡å†™æ‰€æœ‰ä»£ç ï¼
```

**æ ¸å¿ƒç—›ç‚¹å¯¹æ¯”**ï¼š

| æ–¹é¢ | Function Call | MCP |
|-----|--------------|-----|
| **å·¥å…·å®šä¹‰æ ¼å¼** | å„å¹³å°è¯­æ³•ä¸åŒï¼Œéœ€è¦å¤šå¥—é€‚é…ä»£ç  | ç»Ÿä¸€JSON-RPCæ ¼å¼ï¼Œä¸€å¥—ä»£ç å¤šå¹³å°å¤ç”¨ |
| **å¼€å‘å¤æ‚åº¦** | æ¯ä¸ªAIå¹³å°éœ€è¦å•ç‹¬å¼€å‘å’Œç»´æŠ¤ | æ ‡å‡†åŒ–æ¥å£ï¼Œé™ä½å¼€å‘å’Œç»´æŠ¤æˆæœ¬ |
| **ç”Ÿæ€å»ºè®¾** | å„è‡ªä¸ºæ”¿ï¼Œé‡å¤å¼€å‘ç›¸åŒåŠŸèƒ½ | ç¤¾åŒºå…±å»ºï¼Œå·¥å…·å¯è·¨å¹³å°å…±äº« |
| **åè®®æ ‡å‡†åŒ–** | ç¼ºä¹ç»Ÿä¸€æ ‡å‡†ï¼Œå‚å•†å„è‡ªå®šä¹‰ | åŸºäºJSON-RPC 2.0çš„å¼€æ”¾æ ‡å‡†åè®® |
| **æ”¯æŒèŒƒå›´** | ä¸»è¦åœ¨å„è‡ªAIå¹³å°ç”Ÿæ€å†… | ç›®å‰ä¸»è¦æ”¯æŒClaudeç³»åˆ—ï¼Œé€æ­¥æ‰©å±•ä¸­ |

#### MCPçš„æ ¸å¿ƒæ´å¯Ÿ

**è®¾è®¡å“²å­¦**: "æ•°æ®ä¸å·¥å…·æ˜¯å®¢è§‚å­˜åœ¨çš„ï¼Œè¿æ¥æ–¹å¼åº”è¯¥æ ‡å‡†åŒ–"

```
ä¼ ç»Ÿå›°å¢ƒ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å·¥å…·A     â”‚    â”‚   å·¥å…·B     â”‚    â”‚   å·¥å…·C     â”‚
â”‚  (MySQL)    â”‚    â”‚ (æ–‡ä»¶ç³»ç»Ÿ)   â”‚    â”‚  (APIè°ƒç”¨)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
    ä¸“ç”¨æ¥å£           ä¸“ç”¨æ¥å£           ä¸“ç”¨æ¥å£
       â”‚                  â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenAI     â”‚    â”‚   Google    â”‚    â”‚   Claude    â”‚
â”‚ Functions   â”‚    â”‚ Extensions  â”‚    â”‚ Tool Use    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MCPæ–¹æ¡ˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚MCP Server A â”‚    â”‚MCP Server B â”‚    â”‚MCP Server C â”‚
â”‚  (MySQL)    â”‚    â”‚ (æ–‡ä»¶ç³»ç»Ÿ)   â”‚    â”‚  (APIè°ƒç”¨)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
         \                â”‚                /
          \               â”‚               /
           â”€â”€â”€â”€â”€â”€â”€â”€ MCP Protocol â”€â”€â”€â”€â”€â”€â”€â”€
                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        ä»»ä½•æ”¯æŒMCPçš„AIåº”ç”¨                â”‚
    â”‚   OpenAI, Google, Claude, è‡ªå®šä¹‰...      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 MCPçš„æ ¸å¿ƒä»·å€¼

#### å››å¤§æŠ€æœ¯ä¼˜åŠ¿

**1. ç”Ÿæ€ç»Ÿä¸€** - ä¸€æ¬¡å¼€å‘ï¼Œå¤„å¤„è¿è¡Œ
- 100+ ç°æˆMCPæœåŠ¡å™¨å¯ç›´æ¥ä½¿ç”¨
- ç¤¾åŒºå…±å»ºï¼Œé¿å…é‡å¤é€ è½®

**2. å¹³å°æ— å…³** - å‘Šåˆ«å‚å•†é”å®š  
- åŒä¸€å¥—å·¥å…·é€‚é…æ‰€æœ‰AIæ¨¡å‹
- è‡ªç”±é€‰æ‹©æœ€ä½³æ¨¡å‹æ–¹æ¡ˆ

**3. æ•°æ®å®‰å…¨** - æœ¬åœ°å¤„ç†ï¼Œç²¾ç¡®æ§åˆ¶
- æ•æ„Ÿæ•°æ®æ— éœ€ä¸Šä¼ äº‘ç«¯
- ç”¨æˆ·å®Œå…¨æ§åˆ¶æ•°æ®è®¿é—®æƒé™

**4. æ ‡å‡†åŒ–** - ç»Ÿä¸€æ¥å£ï¼Œé™ä½å¤æ‚åº¦
- JSON-RPC 2.0 æ ‡å‡†åè®®
- ç±»å‹å®‰å…¨çš„å‚æ•°éªŒè¯

#### ä¸åŒè§’è‰²çš„ä»·å€¼

**å¯¹å¼€å‘è€…**
- å‡å°‘ 80% çš„é‡å¤å·¥ä½œï¼šä¸€æ¬¡å¼€å‘ï¼Œå¤šå¹³å°å¤ç”¨
- é™ä½å­¦ä¹ æ›²çº¿ï¼šç»Ÿä¸€çš„å¼€å‘æ¨¡å¼å’Œ API
- ä¸°å¯Œçš„ç”Ÿæ€ï¼š100+ ç°æˆçš„ MCP æœåŠ¡å™¨å¯ç›´æ¥ä½¿ç”¨

**å¯¹ä¼ä¸š**
- æ•°æ®å®‰å…¨ï¼šæ•æ„Ÿæ•°æ®ç•™åœ¨æœ¬åœ°ï¼Œç²¾ç¡®æ§åˆ¶è®¿é—®æƒé™  
- é™ä½æˆæœ¬ï¼šé¿å…å‚å•†é”å®šï¼Œçµæ´»é€‰æ‹© AI æ¨¡å‹
- å¿«é€Ÿé›†æˆï¼šæ ‡å‡†åŒ–æ¥å£ï¼ŒåŠ é€Ÿ AI é¡¹ç›®è½åœ°

**å¯¹ç”¨æˆ·**
- æ›´æ™ºèƒ½çš„ AIï¼šèƒ½è®¿é—®å®æ—¶æ•°æ®å’Œä¸“ä¸šå·¥å…·
- æ— ç¼ä½“éªŒï¼šåœ¨ä¸åŒåº”ç”¨é—´ä¿æŒä¸Šä¸‹æ–‡è¿ç»­æ€§
- éšç§ä¿æŠ¤ï¼šæ•°æ®å¤„ç†é€æ˜å¯æ§

---

## 2. MCP æ€ä¹ˆå·¥ä½œ

### 2.1 ä»å®é™…åœºæ™¯ç†è§£MCPå·¥ä½œæµç¨‹

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…åœºæ™¯æ¥ç†è§£MCPæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š

#### åœºæ™¯ï¼šä½ é—®Claude "æˆ‘æ¡Œé¢ä¸Šæœ‰å“ªäº›æ–‡æ¡£ï¼Ÿ"

**MCPäº¤äº’æµç¨‹å›¾**ï¼š

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant H as Claude Desktop<br/>(MCP Host)
    participant C as MCP Client
    participant S as æ–‡ä»¶ç³»ç»Ÿ<br/>MCP Server
    
    U->>H: "æˆ‘æ¡Œé¢ä¸Šæœ‰å“ªäº›æ–‡æ¡£ï¼Ÿ"
    H->>H: Claudeæ¨¡å‹åˆ†æéœ€æ±‚
    Note over H: è¯†åˆ«éœ€è¦æ–‡ä»¶ç³»ç»Ÿè®¿é—®
    H->>C: æ¿€æ´»MCP Client
    C->>S: è¿æ¥æ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨
    S->>S: æ‰«ææ¡Œé¢ç›®å½•
    S-->>C: è¿”å›æ–‡ä»¶åˆ—è¡¨
    C-->>H: ä¼ é€’æ–‡ä»¶ä¿¡æ¯
    H->>H: ç”Ÿæˆè‡ªç„¶è¯­è¨€å›å¤
    H-->>U: "æ‚¨çš„æ¡Œé¢ä¸Šæœ‰3ä¸ªæ–‡æ¡£ï¼š<br/>æŠ¥å‘Š.docxã€ç¬”è®°.txtå’Œé¡¹ç›®.pdf"
```

**å®Œæ•´çš„äº¤äº’æµç¨‹**ï¼š

1. **ç”¨æˆ·æé—®** â†’ "æˆ‘æ¡Œé¢ä¸Šæœ‰å“ªäº›æ–‡æ¡£ï¼Ÿ"
2. **AIåˆ†æ** â†’ è¯†åˆ«éœ€è¦æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™  
3. **MCPè¿æ¥** â†’ æ¿€æ´»æ–‡ä»¶ç³»ç»ŸMCPæœåŠ¡å™¨
4. **æ‰§è¡Œæ“ä½œ** â†’ æ‰«ææ¡Œé¢ç›®å½•ï¼Œè·å–æ–‡ä»¶åˆ—è¡¨
5. **è¿”å›ç»“æœ** â†’ æ•´åˆæ–‡ä»¶ä¿¡æ¯ç”Ÿæˆè‡ªç„¶å›å¤
6. **ç”¨æˆ·è·å¾—ç­”æ¡ˆ** â†’ çœ‹åˆ°çœŸå®çš„æ¡Œé¢æ–‡ä»¶æ¸…å•

è¿™å°±æ˜¯MCPçš„é­…åŠ›ï¼š**è®©AIèƒ½å¤Ÿåƒäººä¸€æ ·ï¼Œåœ¨éœ€è¦æ—¶ä¸»åŠ¨è·å–å®æ—¶ä¿¡æ¯æ¥å›ç­”é—®é¢˜**ã€‚

### 2.2 MCPåŒå±‚æ¶æ„

**MCPæ¶æ„åˆ†å±‚å›¾**ï¼š

```mermaid
graph TB
    subgraph "æ•°æ®å±‚ (Data Layer)"
        DL1[JSON-RPC 2.0 åè®®]
        DL2[ç”Ÿå‘½å‘¨æœŸç®¡ç†]
        DL3[æ ¸å¿ƒåŸè¯­: Tools/Resources/Prompts]
        DL4[æ¶ˆæ¯è¯­ä¹‰è§„èŒƒ]
    end
    
    subgraph "ä¼ è¾“å±‚ (Transport Layer)"
        TL1[STDIOä¼ è¾“<br/>æœ¬åœ°è¿›ç¨‹é€šä¿¡]
        TL2[HTTPä¼ è¾“<br/>è¿œç¨‹æœåŠ¡å™¨é€šä¿¡]
        TL3[è¿æ¥å»ºç«‹ä¸ç®¡ç†]
        TL4[å®‰å…¨é€šä¿¡æœºåˆ¶]
    end
    
    TL1 --> DL1
    TL2 --> DL1
    TL3 --> DL2
    TL4 --> DL4
    
    style DL1 fill:#e1f5fe
    style DL2 fill:#e1f5fe
    style DL3 fill:#e1f5fe
    style DL4 fill:#e1f5fe
    style TL1 fill:#f3e5f5
    style TL2 fill:#f3e5f5
    style TL3 fill:#f3e5f5
    style TL4 fill:#f3e5f5
```

MCPé‡‡ç”¨åˆ†å±‚è®¾è®¡ï¼ŒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒå±‚æ¬¡ï¼š

#### æ•°æ®å±‚ï¼ˆData Layerï¼‰
- **åè®®åŸºç¡€**ï¼šåŸºäºJSON-RPC 2.0çš„é€šä¿¡åè®®
- **ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šå¤„ç†è¿æ¥åˆå§‹åŒ–ã€èƒ½åŠ›åå•†ã€è¿æ¥ç»ˆæ­¢
- **æ ¸å¿ƒåŸè¯­**ï¼šå®šä¹‰Toolsã€Resourcesã€Promptsç­‰åŠŸèƒ½
- **æ¶ˆæ¯è¯­ä¹‰**ï¼šè§„å®šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„äº¤äº’è§„èŒƒ

#### ä¼ è¾“å±‚ï¼ˆTransport Layerï¼‰  
- **é€šä¿¡æœºåˆ¶**ï¼šç®¡ç†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥é€šé“
- **STDIOä¼ è¾“**ï¼šæœ¬åœ°è¿›ç¨‹é—´é€šä¿¡ï¼Œæ€§èƒ½æœ€ä¼˜ï¼Œæ— ç½‘ç»œå¼€é”€
- **HTTPä¼ è¾“**ï¼šè¿œç¨‹æœåŠ¡å™¨é€šä¿¡ï¼Œæ”¯æŒæ ‡å‡†HTTPè®¤è¯
- **æ¶ˆæ¯æ¡†æ¶**ï¼šå¤„ç†è¿æ¥å»ºç«‹ã€æ¶ˆæ¯ä¼ é€’ã€å®‰å…¨é€šä¿¡

**åˆ†å±‚ä¼˜åŠ¿**ï¼š
- æ•°æ®å±‚ä¸“æ³¨åè®®è¯­ä¹‰ï¼Œä¼ è¾“å±‚å¤„ç†é€šä¿¡ç»†èŠ‚
- ç›¸åŒçš„JSON-RPCæ¶ˆæ¯æ ¼å¼é€‚ç”¨äºæ‰€æœ‰ä¼ è¾“æ–¹å¼
- æ¶æ„æ¸…æ™°ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤

### 2.3 æ ¸å¿ƒåŸè¯­æ¦‚è¿°

MCPåŸºäºå®˜æ–¹æ¶æ„è®¾è®¡ï¼Œé‡‡ç”¨åŒå‘é€šä¿¡æ¨¡å¼ï¼ŒåŒ…å«ä¸¤å¤§ç±»æ ¸å¿ƒåŸè¯­ï¼š

**æœåŠ¡å™¨åŸè¯­ï¼ˆServer Primitivesï¼‰**ï¼š
- **Tools (å·¥å…·)** - è®©AIæ‰§è¡Œå…·ä½“æ“ä½œï¼Œå¦‚è¯»å–æ–‡ä»¶ã€æŸ¥è¯¢æ•°æ®åº“ã€è°ƒç”¨APIç­‰
- **Resources (èµ„æº)** - ä¸ºAIæä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€ç³»ç»ŸçŠ¶æ€ã€æ—¥å¿—è®°å½•ç­‰  
- **Prompts (æç¤ºæ¨¡æ¿)** - ä¸ºç‰¹å®šä»»åŠ¡æä¾›æ ‡å‡†åŒ–çš„å¤„ç†æ¨¡æ¿å’Œä¸“ä¸šæŒ‡å¯¼

**å®¢æˆ·ç«¯åŸè¯­ï¼ˆClient Primitivesï¼‰**ï¼š
- **Sampling (é‡‡æ ·)** - æœåŠ¡å™¨å¯è¯·æ±‚å®¢æˆ·ç«¯ä½¿ç”¨AIæ¨¡å‹ç”Ÿæˆå†…å®¹
- **Elicitation (äº¤äº’)** - æœåŠ¡å™¨å¯è¯·æ±‚å®¢æˆ·ç«¯ä»ç”¨æˆ·è·å–é¢å¤–ä¿¡æ¯
- **Logging (æ—¥å¿—)** - æœåŠ¡å™¨å¯å‘å®¢æˆ·ç«¯å‘é€æ—¥å¿—æ¶ˆæ¯

å½“ä½ é—®"æ¡Œé¢ä¸Šæœ‰å“ªäº›æ–‡æ¡£ï¼Ÿ"æ—¶ï¼ŒAIä¸»è¦é€šè¿‡æœåŠ¡å™¨åŸè¯­ä¸­çš„Toolsæ‰«ææ–‡ä»¶ç³»ç»Ÿï¼Œå¿…è¦æ—¶å¯ç»“åˆResourcesäº†è§£ç³»ç»Ÿç¯å¢ƒã€‚

> **æŠ€æœ¯å®ç°è¯¦è§£**ï¼šå®Œæ•´çš„æŠ€æœ¯è§„èŒƒã€ä»£ç ç¤ºä¾‹å’Œå¼€å‘æŒ‡å—è¯·å‚è€ƒç¬¬3ç« ã€ŠMCPæŠ€æœ¯æ·±å…¥ã€‹ã€‚

### 2.4 MCPäº¤äº’æµç¨‹æ€»è§ˆ

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†MCPçš„æ ¸å¿ƒåŸè¯­ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•ååŒå·¥ä½œçš„ï¼š

#### å®é™…è¿è¡Œç¤ºä¾‹

ä»¥"å¸®æˆ‘æ•´ç†æ¡Œé¢æ–‡ä»¶"ä¸ºä¾‹ï¼š

**æ­¥éª¤åˆ†è§£**ï¼š
1. **ç”¨æˆ·è¯·æ±‚** â†’ "å¸®æˆ‘æ•´ç†æ¡Œé¢æ–‡ä»¶"
2. **AIåˆ†æ** â†’ éœ€è¦æ–‡ä»¶ä¿¡æ¯ + æ•´ç†å»ºè®®
3. **èƒ½åŠ›è°ƒç”¨**ï¼š
   - **Tools**: æ‰«ææ¡Œé¢æ–‡ä»¶
   - **Resources**: è¯»å–ç³»ç»Ÿä¿¡æ¯  
   - **Prompts**: åº”ç”¨æ•´ç†æ¨¡æ¿
4. **ç»“æœæ•´åˆ** â†’ ä¸ªæ€§åŒ–çš„æ–‡ä»¶æ•´ç†æ–¹æ¡ˆ
5. **å›å¤ç”¨æˆ·** â†’ æä¾›å…·ä½“æ•´ç†å»ºè®®

> **æƒ³æ·±å…¥äº†è§£æŠ€æœ¯å®ç°ç»†èŠ‚ï¼Ÿ** åŒ…æ‹¬åŒå‘é€šä¿¡æœºåˆ¶ã€å·¥å…·é€‰æ‹©ç®—æ³•ã€æ¶æ„è®¾è®¡åŸç†ç­‰ï¼Œè¯·å‚è€ƒç¬¬3ç« ã€ŠMCPæŠ€æœ¯æ·±å…¥ã€‹ã€‚


---

## 3. MCP æŠ€æœ¯æ·±å…¥

æœ¬ç« æ·±å…¥è§£æMCPçš„æ ¸å¿ƒæ¶æ„ã€‚æ ¹æ®å®˜æ–¹æ¶æ„æ–‡æ¡£ï¼ŒMCPåè®®é‡‡ç”¨åŒå‘é€šä¿¡è®¾è®¡ï¼ŒåŒ…å«ä¸¤å¤§ç±»æ ¸å¿ƒåŸè¯­ï¼š

- **æœåŠ¡å™¨åŸè¯­**ï¼ˆServer Primitivesï¼‰ï¼šToolsã€Resourcesã€Prompts - ç”±æœåŠ¡å™¨å®ç°å¹¶å‘å®¢æˆ·ç«¯å…¬å¼€
- **å®¢æˆ·ç«¯åŸè¯­**ï¼ˆClient Primitivesï¼‰ï¼šSamplingã€Elicitationã€Logging - ç”±å®¢æˆ·ç«¯å®ç°å¹¶å‘æœåŠ¡å™¨æä¾›

è¿™ç§å¯¹ç§°è®¾è®¡ä½¿å¾—æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ½èƒ½ä¸»åŠ¨å‘èµ·äº¤äº’ï¼Œæ„å»ºäº†çœŸæ­£çš„åŒå‘é€šä¿¡èƒ½åŠ›ã€‚

### 3.1 æœåŠ¡å™¨åŸè¯­ï¼ˆServer Primitivesï¼‰

**ç†è§£æœåŠ¡å™¨åŸè¯­çš„æ ¸å¿ƒæ€è·¯**ï¼šæŠŠMCPæœåŠ¡å™¨æƒ³è±¡æˆä¸€ä¸ª"å·¥å…·ç®±"ï¼Œé‡Œé¢è£…ç€AIå¯ä»¥ä½¿ç”¨çš„å„ç§èƒ½åŠ›ã€‚å°±åƒç°å®ä¸­çš„å·¥å…·ç®±æœ‰èºä¸åˆ€ã€æ‰³æ‰‹ã€é”¤å­ï¼ŒMCPå·¥å…·ç®±é‡Œæœ‰Toolsï¼ˆå¹²æ´»çš„å·¥å…·ï¼‰ã€Resourcesï¼ˆå‚è€ƒèµ„æ–™ï¼‰ã€Promptsï¼ˆæ“ä½œæ‰‹å†Œï¼‰ã€‚

**å®é™…ä½¿ç”¨åˆ†å¸ƒ**ï¼š
- **Tools (90%+)**ï¼šæ—¥å¸¸ä½¿ç”¨çš„ä¸»åŠ›å·¥å…·ï¼Œå¦‚è¯»æ–‡ä»¶ã€æŸ¥æ•°æ®åº“ã€è°ƒAPI
- **Resources (<20%)**ï¼šæä¾›èƒŒæ™¯ä¿¡æ¯ï¼Œå¦‚ç³»ç»Ÿé…ç½®ã€ç¯å¢ƒçŠ¶æ€  
- **Prompts (<5%)**ï¼šç‰¹æ®Šåœºæ™¯çš„ä¸“ä¸šæ¨¡æ¿ï¼Œå¦‚ä»£ç å®¡æŸ¥ã€æ–‡æ¡£ç”Ÿæˆ

æœåŠ¡å™¨åŸè¯­æ˜¯MCPåè®®çš„æ ¸å¿ƒç»„ä»¶ï¼Œç”±æœåŠ¡å™¨å®ç°å¹¶å‘å®¢æˆ·ç«¯å…¬å¼€ã€‚æ ¹æ®å®˜æ–¹æ¶æ„æ ‡å‡†ï¼ŒåŒ…å«ä¸‰ç§ç±»å‹ï¼š

#### 3.1.1 Tools - å·¥å…·è°ƒç”¨

**å®šä¹‰**ï¼šToolsæ˜¯MCPæœåŠ¡å™¨å‘å®¢æˆ·ç«¯å…¬å¼€çš„å¯è°ƒç”¨å‡½æ•°ï¼Œè®©AIèƒ½å¤Ÿæ‰§è¡Œå…·ä½“æ“ä½œã€‚

**å¦‚ä½•å®šä¹‰å·¥å…·**ï¼š
```python
from mcp.server.fastmcp import FastMCP

mcp = FastMCP("æ–‡ä»¶ç®¡ç†å·¥å…·")

@mcp.tool()
def read_file(file_path: str) -> str:
    """è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹
    
    Args:
        file_path: æ–‡ä»¶è·¯å¾„
        
    Returns:
        æ–‡ä»¶å†…å®¹å­—ç¬¦ä¸²
    """
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except FileNotFoundError:
        return f"é”™è¯¯ï¼šæ–‡ä»¶ {file_path} ä¸å­˜åœ¨"
    except Exception as e:
        return f"è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼š{str(e)}"
```

**å¦‚ä½•ä½¿ç”¨å·¥å…·**ï¼š
1. AIåˆ†æç”¨æˆ·éœ€æ±‚ï¼Œè‡ªåŠ¨é€‰æ‹©åˆé€‚å·¥å…·
2. AIå¡«å……å¿…è¦å‚æ•°ï¼Œè°ƒç”¨å·¥å…·å‡½æ•°
3. å·¥å…·æ‰§è¡Œåè¿”å›ç»“æœç»™AI
4. AIåŸºäºç»“æœç”Ÿæˆç”¨æˆ·å‹å¥½çš„å›å¤

**å®é™…æ•ˆæœ**ï¼š
- ç”¨æˆ·è¯´ï¼š"å¸®æˆ‘è¯»å–config.jsonæ–‡ä»¶å†…å®¹"
- AIè‡ªåŠ¨è°ƒç”¨`read_file("config.json")`
- è¿”å›æ–‡ä»¶å†…å®¹æˆ–é”™è¯¯ä¿¡æ¯


#### 3.1.2 Resources - èµ„æºè®¿é—®ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰

**å®šä¹‰**ï¼šResourcesä¸ºAIæä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€ç³»ç»ŸçŠ¶æ€ç­‰ã€‚

**å¦‚ä½•å®šä¹‰èµ„æº**ï¼š
```python
@mcp.resource("config://app/settings")
def get_app_config():
    """è·å–åº”ç”¨é…ç½®ä¿¡æ¯"""
    return {
        "name": "My App",
        "version": "1.0.0",
        "debug_mode": False
    }
```

**ä½¿ç”¨åœºæ™¯**ï¼šAIå¯ä»¥é€šè¿‡`@config://app/settings`å¼•ç”¨æ­¤èµ„æºï¼Œè·å–åº”ç”¨é…ç½®ä¿¡æ¯æ¥æä¾›æ›´å‡†ç¡®çš„å»ºè®®ã€‚å®é™…ä½¿ç”¨ä¸­è¾ƒå°‘ï¼Œå¤§å¤šæ•°æƒ…å†µé€šè¿‡Toolsè·å–æ•°æ®æ›´ç›´æ¥ã€‚

#### 3.1.3 Prompts - æç¤ºæ¨¡æ¿ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰

**å®šä¹‰**ï¼šPromptsæ˜¯é¢„å®šä¹‰æ¨¡æ¿ï¼Œä¸ºç‰¹å®šä»»åŠ¡æä¾›æ ‡å‡†åŒ–å¤„ç†æ¨¡æ¿ã€‚

**å¦‚ä½•å®šä¹‰æç¤ºæ¨¡æ¿**ï¼š
```python
@mcp.prompt()
def code_review_prompt(code: str) -> str:
    """ä»£ç å®¡æŸ¥æç¤ºæ¨¡æ¿"""
    return f"""è¯·å®¡æŸ¥ä»¥ä¸‹ä»£ç çš„ï¼š
1. ä»£ç è§„èŒƒå’Œé£æ ¼
2. æ½œåœ¨çš„bugå’Œå®‰å…¨é—®é¢˜
3. æ€§èƒ½ä¼˜åŒ–å»ºè®®
4. å¯è¯»æ€§å’Œç»´æŠ¤æ€§

ä»£ç ï¼š
{code}
"""
```

**ä½¿ç”¨åœºæ™¯**ï¼šé€šè¿‡`/code-review`å‘½ä»¤è°ƒç”¨æ­¤æ¨¡æ¿ï¼Œä¸ºä»£ç å®¡æŸ¥æä¾›æ ‡å‡†åŒ–æŒ‡å¯¼ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨è¾ƒå°‘ã€‚

### 3.2 å®¢æˆ·ç«¯åŸè¯­ï¼ˆClient Primitivesï¼‰

**ç†è§£å®¢æˆ·ç«¯åŸè¯­çš„æ ¸å¿ƒæ€è·¯**ï¼šå¦‚æœè¯´æœåŠ¡å™¨åŸè¯­æ˜¯"AIèƒ½è°ƒç”¨çš„å·¥å…·"ï¼Œé‚£å®¢æˆ·ç«¯åŸè¯­å°±æ˜¯"å·¥å…·èƒ½åè¿‡æ¥è¯·æ±‚AIåšçš„äº‹"ã€‚è¿™å®ç°äº†çœŸæ­£çš„åŒå‘é€šä¿¡ï¼šä¸ä»…AIèƒ½ä½¿ç”¨å·¥å…·ï¼Œå·¥å…·ä¹Ÿèƒ½"å›è°ƒ"AIã€‚

**å…¸å‹ä½¿ç”¨åœºæ™¯**ï¼š
- **ä»£ç ç”Ÿæˆå·¥å…·**ï¼šè¯·æ±‚AIæ ¹æ®éœ€æ±‚ç”Ÿæˆä»£ç ï¼ˆSamplingï¼‰
- **é…ç½®å‘å¯¼**ï¼šè¯·æ±‚ç”¨æˆ·è¾“å…¥APIå¯†é’¥ã€é€‰æ‹©ç¯å¢ƒï¼ˆElicitationï¼‰  
- **ç›‘æ§ç³»ç»Ÿ**ï¼šå‘å®¢æˆ·ç«¯å‘é€è¿è¡ŒçŠ¶æ€ã€é”™è¯¯ä¿¡æ¯ï¼ˆLoggingï¼‰

**å®é™…ä½¿ç”¨é¢‘ç‡è¾ƒä½**ï¼šå¤§å¤šæ•°MCPå·¥å…·åªéœ€è¦æœåŠ¡å™¨åŸè¯­å°±å¤Ÿç”¨äº†ï¼Œå®¢æˆ·ç«¯åŸè¯­ä¸»è¦ç”¨äºé«˜çº§äº¤äº’åœºæ™¯ã€‚

å®¢æˆ·ç«¯åŸè¯­æ˜¯MCPå®¢æˆ·ç«¯æä¾›ç»™æœåŠ¡å™¨çš„èƒ½åŠ›ï¼Œå®ç°æœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯çš„åå‘è°ƒç”¨ã€‚

#### 3.2.1 Sampling - æ¨¡å‹æ¨ç†

**ä½œç”¨**ï¼šæœåŠ¡å™¨å¯ä»¥è¯·æ±‚å®¢æˆ·ç«¯ä½¿ç”¨AIæ¨¡å‹ç”Ÿæˆå†…å®¹

**ä½¿ç”¨åœºæ™¯**ï¼š
```python
# æœåŠ¡å™¨è¯·æ±‚å®¢æˆ·ç«¯ç”Ÿæˆä»£ç 
def generate_code_suggestion(requirements: str):
    """è¯·æ±‚AIç”Ÿæˆä»£ç å»ºè®®"""
    prompt = f"æ ¹æ®éœ€æ±‚ç”ŸæˆPythonä»£ç ï¼š{requirements}"
    
    # å‘å®¢æˆ·ç«¯å‘èµ·é‡‡æ ·è¯·æ±‚
    response = client.sampling.create_message(
        messages=[{"role": "user", "content": prompt}],
        max_tokens=500,
        temperature=0.7
    )
    
    return response.content
```

#### 3.2.2 Elicitation - ç”¨æˆ·äº¤äº’

**ä½œç”¨**ï¼šæœåŠ¡å™¨å¯ä»¥è¯·æ±‚å®¢æˆ·ç«¯ä»ç”¨æˆ·è·å–é¢å¤–ä¿¡æ¯

**å®ç°ç¤ºä¾‹**ï¼š
```python
def interactive_setup():
    """äº¤äº’å¼é…ç½®è®¾ç½®"""
    
    # è¯·æ±‚ç”¨æˆ·è¾“å…¥APIå¯†é’¥
    api_key = client.elicitation.request_input(
        prompt="è¯·è¾“å…¥æ‚¨çš„APIå¯†é’¥ï¼š",
        input_type="password"
    )
    
    # è¯·æ±‚ç”¨æˆ·é€‰æ‹©é…ç½®é€‰é¡¹
    env = client.elicitation.request_choice(
        prompt="é€‰æ‹©è¿è¡Œç¯å¢ƒï¼š",
        choices=["development", "staging", "production"]
    )
    
    return {"api_key": api_key, "environment": env}
```

#### 3.2.3 Logging - æ—¥å¿—è®°å½•

**ä½œç”¨**ï¼šæœåŠ¡å™¨å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€æ—¥å¿—ä¿¡æ¯

**æ—¥å¿—çº§åˆ«å’Œä½¿ç”¨**ï¼š
```python
import logging

def complex_operation():
    """æ¼”ç¤ºæ—¥å¿—è®°å½•çš„å¤æ‚æ“ä½œ"""
    
    client.logging.log(
        level="INFO", 
        message="å¼€å§‹æ‰§è¡Œå¤æ‚æ“ä½œ"
    )
    
    try:
        # æ‰§è¡ŒæŸäº›æ“ä½œ
        result = perform_calculation()
        
        client.logging.log(
            level="DEBUG",
            message=f"è®¡ç®—ç»“æœ: {result}"
        )
        
        return result
        
    except Exception as e:
        client.logging.log(
            level="ERROR",
            message=f"æ“ä½œå¤±è´¥: {str(e)}"
        )
        raise
```

### 3.3 AIå·¥å…·é€‰æ‹©æœºåˆ¶æ·±åº¦è§£æ

MCPæœ€ç¥å¥‡çš„åœ°æ–¹åœ¨äºï¼š**AIæ˜¯å¦‚ä½•ä»ä¼—å¤šå·¥å…·ä¸­ç²¾ç¡®é€‰æ‹©åˆé€‚çš„é‚£ä¸€ä¸ª**ï¼Ÿè¿™èƒŒåçš„åŸç†å€¼å¾—æ·±å…¥äº†è§£ã€‚

#### 3.3.1 å·¥å…·å¦‚ä½•"è‡ªæˆ‘ä»‹ç»"ï¼šæè¿°æ ¼å¼åŒ–æœºåˆ¶

**æ ¸å¿ƒé—®é¢˜**ï¼šMCPå·¥å…·å¦‚ä½•è®©AI"çœ‹æ‡‚"è‡ªå·±ï¼Ÿ

**å…³é”®æ´å¯Ÿ**ï¼šAIæ— æ³•ç›´æ¥ç†è§£ä»£ç ï¼Œåªèƒ½é€šè¿‡æ–‡æœ¬æè¿°æ¥è®¤è¯†å·¥å…·ã€‚MCPæ¡†æ¶ä¼šè‡ªåŠ¨å°†æ¯ä¸ªå·¥å…·è½¬æ¢ä¸ºAIå¯ç†è§£çš„ç»“æ„åŒ–æ–‡æœ¬ã€‚

**ç¬¬ä¸€æ­¥ï¼šå·¥å…·æè¿°è‡ªåŠ¨æ ¼å¼åŒ–**

å½“ç”¨æˆ·æé—®æ—¶ï¼ŒMCPå®¢æˆ·ç«¯ä¼šå°†æ‰€æœ‰å¯ç”¨å·¥å…·è½¬æ¢ä¸ºç»“æ„åŒ–æ–‡æœ¬ï¼š

```python
# å·¥å…·æè¿°æ ¼å¼åŒ–æœºåˆ¶
class Tool:
    def format_for_llm(self) -> str:
        """å°†å·¥å…·ä¿¡æ¯æ ¼å¼åŒ–ä¸ºAIå¯ç†è§£çš„æ–‡æœ¬"""
        args_desc = []
        if "properties" in self.input_schema:
            for param_name, param_info in self.input_schema["properties"].items():
                arg_desc = f"- {param_name}: {param_info.get('description', 'No description')}"
                if param_name in self.input_schema.get("required", []):
                    arg_desc += " (required)"
                args_desc.append(arg_desc)
        
        return f"""
Tool: {self.name}
Description: {self.description}
Arguments:
{chr(10).join(args_desc)}
"""
```

**ç¬¬äºŒæ­¥ï¼šæ„å»ºSystem Prompt**

æ‰€æœ‰å·¥å…·æè¿°ä¼šè¢«æ•´åˆåˆ°ä¸€ä¸ªç»Ÿä¸€çš„system promptä¸­ï¼š

```python
# System Promptæ„å»ºï¼ˆåŸºäºå®é™…MCPæºç ï¼‰
async def start(self):
    # è·å–æ‰€æœ‰å·¥å…·
    all_tools = []
    for server in self.servers:
        tools = await server.list_tools()
        all_tools.extend(tools)
    
    # æ ¼å¼åŒ–å·¥å…·æè¿°
    tools_description = "\n".join([tool.format_for_llm() for tool in all_tools])
    
    # æ„å»ºSystem Prompt
    system_message = (
        "You are a helpful assistant with access to these tools:\n\n"
        f"{tools_description}\n"
        "Choose the appropriate tool based on the user's question. "
        "If no tool is needed, reply directly.\n\n"
        "IMPORTANT: When you need to use a tool, you must ONLY respond with "
        "the exact JSON object format below, nothing else:\n"
        '{"tool": "tool-name", "arguments": {"argument-name": "value"}}\n\n'
        "After receiving a tool's response:\n"
        "1. Transform the raw data into a natural, conversational response\n"
        "2. Keep responses concise but informative\n"
        "3. Focus on the most relevant information"
    )
```

**å·¥å…·ä¿¡æ¯çš„è‡ªåŠ¨æå–**

MCPé€šè¿‡è£…é¥°å™¨è‡ªåŠ¨æå–å·¥å…·å…ƒä¿¡æ¯ï¼š

```python
@mcp.tool()
def get_weather(city: str, unit: str = "celsius") -> str:
    """è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯
    
    Args:
        city: åŸå¸‚åç§°ï¼Œå¦‚"åŒ—äº¬"ã€"ä¸Šæµ·"
        unit: æ¸©åº¦å•ä½ï¼Œæ”¯æŒcelsiuså’Œfahrenheitï¼Œé»˜è®¤celsius
    """
    # å·¥å…·å®ç°
```

**è‡ªåŠ¨æå–çš„ä¿¡æ¯**ï¼š
- **name**: å‡½æ•°å `get_weather`
- **description**: docstringä¸­çš„æè¿°  
- **arguments**: é€šè¿‡ç±»å‹æ³¨è§£æ¨æ–­å‚æ•°ç±»å‹å’Œè¦æ±‚
- **required**: æ— é»˜è®¤å€¼çš„å‚æ•°è‡ªåŠ¨æ ‡è®°ä¸ºrequired

#### 3.3.2 AIå¦‚ä½•"ä½¿ç”¨å·¥å…·"ï¼šè°ƒç”¨æ‰§è¡Œæœºåˆ¶

**æ ¸å¿ƒé—®é¢˜**ï¼šAIæ‹¿åˆ°å·¥å…·æè¿°åï¼Œå¦‚ä½•å†³å®šä½¿ç”¨å“ªä¸ªå·¥å…·å¹¶æ‰§è¡Œï¼Ÿ

**æ‰§è¡Œé€»è¾‘**ï¼šAIé€šè¿‡åˆ†æç”¨æˆ·é—®é¢˜å’Œå·¥å…·æè¿°ï¼Œè¾“å‡ºJSONæ ¼å¼çš„è°ƒç”¨æŒ‡ä»¤ï¼Œç„¶åç³»ç»Ÿæ‰§è¡Œå·¥å…·å¹¶å°†ç»“æœåé¦ˆç»™AIã€‚

```mermaid
flowchart LR
    A[ç”¨æˆ·æé—®] --> B[æ ¼å¼åŒ–å·¥å…·æè¿°]
    B --> C[å‘é€ç»™AIæ¨¡å‹]
    C --> D{éœ€è¦å·¥å…·?}
    D -->|æ˜¯| E[è¾“å‡ºJSONè°ƒç”¨]
    D -->|å¦| F[ç›´æ¥å›å¤]
    E --> G[æ‰§è¡Œå·¥å…·]
    G --> H[ç»“æœ+åŸé—®é¢˜é‡æ–°å‘ç»™AI]
    H --> I[ç”Ÿæˆæœ€ç»ˆå›å¤]
```

é€šè¿‡æºç æ·±å…¥åˆ†æï¼ŒAIä½¿ç”¨å·¥å…·çš„è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå…³é”®æ­¥éª¤ï¼š

**æ­¥éª¤1ï¼šAIåˆ†æå†³ç­–é˜¶æ®µ**
AIåˆ†æç”¨æˆ·é—®é¢˜ï¼Œå¯¹æ¯”æ‰€æœ‰å·¥å…·æè¿°ï¼Œå†³å®šæ˜¯å¦éœ€è¦å·¥å…·ä»¥åŠé€‰æ‹©å“ªä¸ªå·¥å…·ï¼š

```python
# ç®€åŒ–çš„æ ¸å¿ƒæ‰§è¡Œé€»è¾‘
while True:
    # ç”¨æˆ·è¾“å…¥æ¶ˆæ¯
    messages.append({"role": "user", "content": user_input})
    
    # å‘é€ç»™AIæ¨¡å‹ï¼ˆåŒ…å«system promptå’Œç”¨æˆ·æ¶ˆæ¯ï¼‰
    llm_response = self.llm_client.get_response(messages)
    
    # å¤„ç†AIå“åº”ï¼ˆæ£€æŸ¥æ˜¯å¦åŒ…å«å·¥å…·è°ƒç”¨ï¼‰
    result = await self.process_llm_response(llm_response)
    
    # å¦‚æœæ‰§è¡Œäº†å·¥å…·ï¼Œå°†ç»“æœé‡æ–°å‘ç»™AI
    if result != llm_response:
        messages.append({"role": "assistant", "content": llm_response})
        messages.append({"role": "system", "content": result})
        
        # è·å–æœ€ç»ˆå›å¤
        final_response = self.llm_client.get_response(messages)
        messages.append({"role": "assistant", "content": final_response})
    else:
        # æ— éœ€å·¥å…·ï¼Œç›´æ¥è¿”å›
        messages.append({"role": "assistant", "content": llm_response})
```

**æ­¥éª¤2ï¼šç³»ç»Ÿæ‰§è¡Œé˜¶æ®µ**
ç³»ç»Ÿæ¥æ”¶AIçš„è°ƒç”¨æŒ‡ä»¤ï¼Œæ‰§è¡Œå…·ä½“å·¥å…·ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™AIï¼š

```python
async def process_llm_response(self, llm_response):
    """å¤„ç†AIå“åº”ï¼Œæ‰§è¡Œå·¥å…·è°ƒç”¨"""
    # æ£€æŸ¥æ˜¯å¦åŒ…å«JSONæ ¼å¼çš„å·¥å…·è°ƒç”¨
    if self.is_tool_call(llm_response):
        try:
            # è§£æå·¥å…·è°ƒç”¨JSON
            tool_call = self.parse_tool_call(llm_response)
            
            # æ‰§è¡ŒæŒ‡å®šå·¥å…·
            result = await self.execute_tool(tool_call)
            
            return result
            
        except Exception as e:
            # å®¹é”™å¤„ç†ï¼šè·³è¿‡æ— æ•ˆå·¥å…·è°ƒç”¨
            return llm_response
    
    return llm_response
```

**å…³é”®è®¾è®¡æ´å¯Ÿ**ï¼š
- **Promptå·¥ç¨‹æ ¸å¿ƒ**ï¼šæ‰€æœ‰å·¥å…·é€‰æ‹©åŸºäºç»“æ„åŒ–æ–‡æœ¬æè¿°ï¼Œä»»ä½•æ”¯æŒPromptçš„æ¨¡å‹ç†è®ºä¸Šéƒ½èƒ½ä½¿ç”¨MCP
- **Claudeä¸“é¡¹ä¼˜åŒ–**ï¼šAnthropicé’ˆå¯¹Claudeåšäº†ä¸“é—¨çš„MCPè®­ç»ƒï¼Œå› æ­¤Claudeåœ¨å·¥å…·é€‰æ‹©å‡†ç¡®æ€§ä¸Šè¡¨ç°æ›´å¥½
- **åŒè½®å¯¹è¯æœºåˆ¶**ï¼šå·¥å…·æ‰§è¡Œç»“æœä¸åŸé—®é¢˜ä¸€èµ·é‡æ–°å‘é€ç»™AIï¼Œç¡®ä¿AIèƒ½åŸºäºå®é™…æ•°æ®ç”Ÿæˆè‡ªç„¶å›å¤
- **å®¹é”™è®¾è®¡**ï¼šæ— æ•ˆçš„å·¥å…·è°ƒç”¨è¢«è‡ªåŠ¨è·³è¿‡ï¼Œä¿è¯å¯¹è¯è¿ç»­æ€§

#### 3.3.3 å¼€å‘æœ€ä½³å®è·µ

**å·¥å…·æè¿°ä¼˜åŒ–**

```python
# âŒ æ¨¡ç³Šçš„æè¿°
@mcp.tool()
def process_data(data: str) -> str:
    """å¤„ç†æ•°æ®"""
    pass

# âœ… æ¸…æ™°çš„æè¿°  
@mcp.tool()
def analyze_sales_data(csv_data: str) -> str:
    """åˆ†æé”€å”®æ•°æ®å¹¶ç”ŸæˆæŠ¥å‘Š
    
    åŠŸèƒ½ï¼šè§£æCSVæ ¼å¼çš„é”€å”®æ•°æ®ï¼Œè®¡ç®—æ€»é”€å”®é¢ã€å¹³å‡è®¢å•ä»·å€¼ã€
    æœ€ä½³é”€å”®äº§å“ç­‰å…³é”®æŒ‡æ ‡ï¼Œå¹¶ç”Ÿæˆç»“æ„åŒ–çš„åˆ†ææŠ¥å‘Šã€‚
    
    Args:
        csv_data: CSVæ ¼å¼çš„é”€å”®æ•°æ®ï¼Œå¿…é¡»åŒ…å«date,product,amountåˆ—
        
    Returns:
        åŒ…å«é”€å”®åˆ†æç»“æœçš„JSONæ ¼å¼æŠ¥å‘Š
    """
    pass
```

**å‚æ•°è®¾è®¡åŸåˆ™**

1. **å‚æ•°åè¦è¯­ä¹‰åŒ–**: ä½¿ç”¨`city_name`è€Œä¸æ˜¯`c`
2. **æä¾›é»˜è®¤å€¼**: å‡å°‘å¿…éœ€å‚æ•°æ•°é‡
3. **ç±»å‹æ³¨è§£å®Œæ•´**: å¸®åŠ©MCPç”Ÿæˆå‡†ç¡®çš„å‚æ•°æè¿°
4. **æ–‡æ¡£å­—ç¬¦ä¸²è¯¦ç»†**: è¯´æ˜å‚æ•°ç”¨é€”ã€æ ¼å¼è¦æ±‚ã€ç¤ºä¾‹å€¼

---

## 4. å¼€å‘å®æˆ˜æŒ‡å— (åŠ¨æ‰‹å®è·µ)

### 4.1 5åˆ†é’Ÿåˆ›å»ºç¬¬ä¸€ä¸ªMCPå·¥å…·

#### ç›®æ ‡ï¼šåˆ›å»ºä¸€ä¸ªå¤©æ°”æŸ¥è¯¢æœåŠ¡å™¨
åŸºäºå®˜æ–¹ç¤ºä¾‹ï¼Œè®©Claudeèƒ½å¤ŸæŸ¥è¯¢ç¾å›½å¤©æ°”é¢„æŠ¥å’Œç¾å®³é¢„è­¦

#### äº”æ­¥æå®š

**Step 1: ç¯å¢ƒæ­å»º**
```bash
# å®‰è£…ç°ä»£PythonåŒ…ç®¡ç†å™¨
curl -LsSf https://astral.sh/uv/install.sh | sh

# åˆ›å»ºé¡¹ç›®
mkdir weather-server && cd weather-server
uv init --python=3.11

# å®‰è£…ä¾èµ–
uv add "mcp[cli]" httpx

# åˆ›å»ºæ–‡ä»¶
touch weather.py
```

**Step 2: æ ¸å¿ƒä»£ç **

#### ä»£ç ç»“æ„ç¤ºæ„å›¾

```
weather.py æ ¸å¿ƒç»„ä»¶
â”œâ”€â”€ ğŸ› ï¸ MCPå·¥å…·ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”œâ”€â”€ get_alerts(state)     # å¤©æ°”é¢„è­¦
â”‚   â””â”€â”€ get_forecast(lat,lon) # å¤©æ°”é¢„æŠ¥
â”œâ”€â”€ ğŸ”§ è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ make_nws_request()    # APIè°ƒç”¨
â”‚   â””â”€â”€ format_alert()       # æ•°æ®æ ¼å¼åŒ–
â””â”€â”€ ğŸš€ mcp.run()             # å¯åŠ¨æœåŠ¡å™¨
```

#### æ•°æ®æµå‘å›¾

```
ç”¨æˆ·æé—® â†’ Claude â†’ MCPå®¢æˆ·ç«¯ â†’ weather.py â†’ ç¾å›½æ°”è±¡å±€API
    â†‘                                â†“              â†“
æ ¼å¼åŒ–å›ç­” â† Claude â† MCPå®¢æˆ·ç«¯ â† æ•°æ®å¤„ç† â† JSONå“åº”
```

<details>
<summary>ç‚¹å‡»å±•å¼€å®Œæ•´ä»£ç  (weather.py)</summary>

```python
from typing import Any
import httpx
from mcp.server.fastmcp import FastMCP

# åˆå§‹åŒ–FastMCPæœåŠ¡å™¨
mcp = FastMCP("weather")

# å¸¸é‡é…ç½®
NWS_API_BASE = "https://api.weather.gov"
USER_AGENT = "weather-app/1.0"

async def make_nws_request(url: str) -> dict[str, Any] | None:
    """å‘NWS APIå‘é€è¯·æ±‚ï¼Œå¸¦é”™è¯¯å¤„ç†"""
    headers = {
        "User-Agent": USER_AGENT,
        "Accept": "application/geo+json"
    }
    
    async with httpx.AsyncClient() as client:
        try:
            response = await client.get(url, headers=headers, timeout=30.0)
            response.raise_for_status()
            return response.json()
        except Exception:
            return None

def format_alert(feature: dict) -> str:
    """æ ¼å¼åŒ–é¢„è­¦ä¿¡æ¯ä¸ºå¯è¯»å­—ç¬¦ä¸²"""
    props = feature["properties"]
    return f"""
äº‹ä»¶: {props.get('event', 'Unknown')}
åŒºåŸŸ: {props.get('areaDesc', 'Unknown')}
ä¸¥é‡ç¨‹åº¦: {props.get('severity', 'Unknown')}
æè¿°: {props.get('description', 'No description available')}
æŒ‡å¯¼: {props.get('instruction', 'No specific instructions provided')}
"""

@mcp.tool()
async def get_alerts(state: str) -> str:
    """è·å–ç¾å›½å·çš„å¤©æ°”é¢„è­¦
    
    Args:
        state: ç¾å›½å·ä»£ç ï¼Œå¦‚CAã€NY
    """
    url = f"{NWS_API_BASE}/alerts/active/area/{state}"
    data = await make_nws_request(url)
    
    if not data or "features" not in data:
        return "æ— æ³•è·å–é¢„è­¦ä¿¡æ¯æˆ–æœªæ‰¾åˆ°é¢„è­¦ã€‚"
    
    if not data["features"]:
        return "è¯¥å·æ²¡æœ‰æ´»è·ƒçš„å¤©æ°”é¢„è­¦ã€‚"
    
    alerts = [format_alert(feature) for feature in data["features"]]
    return "\n---\n".join(alerts)

@mcp.tool()
async def get_forecast(latitude: float, longitude: float) -> str:
    """è·å–æŒ‡å®šä½ç½®çš„å¤©æ°”é¢„æŠ¥
    
    Args:
        latitude: çº¬åº¦
        longitude: ç»åº¦
    """
    # é¦–å…ˆè·å–é¢„æŠ¥ç½‘æ ¼ç«¯ç‚¹
    points_url = f"{NWS_API_BASE}/points/{latitude},{longitude}"
    points_data = await make_nws_request(points_url)
    
    if not points_data:
        return "æ— æ³•è·å–è¯¥ä½ç½®çš„é¢„æŠ¥æ•°æ®ã€‚"
    
    # ä»pointså“åº”ä¸­è·å–é¢„æŠ¥URL
    forecast_url = points_data["properties"]["forecast"]
    forecast_data = await make_nws_request(forecast_url)
    
    if not forecast_data:
        return "æ— æ³•è·å–è¯¦ç»†é¢„æŠ¥ã€‚"
    
    # æ ¼å¼åŒ–é¢„æŠ¥æ—¶æ®µä¸ºå¯è¯»æ ¼å¼
    periods = forecast_data["properties"]["periods"]
    forecasts = []
    
    for period in periods[:5]:  # åªæ˜¾ç¤ºæ¥ä¸‹æ¥5ä¸ªæ—¶æ®µ
        forecast = f"""
{period['name']}:
æ¸©åº¦: {period['temperature']}Â°{period['temperatureUnit']}
é£åŠ›: {period['windSpeed']} {period['windDirection']}
é¢„æŠ¥: {period['detailedForecast']}
"""
        forecasts.append(forecast)
    
    return "\n---\n".join(forecasts)

if __name__ == "__main__":
    # åˆå§‹åŒ–å¹¶è¿è¡ŒæœåŠ¡å™¨
    mcp.run(transport='stdio')
```

</details>

**Step 3: æµ‹è¯•æœåŠ¡å™¨**

æœåŠ¡å™¨ä»£ç å®Œæˆåï¼Œé¦–å…ˆè¿›è¡Œç‹¬ç«‹æµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸ï¼š

```bash
# å¯åŠ¨MCPæœåŠ¡å™¨ï¼ˆç‹¬ç«‹è¿è¡Œæ¨¡å¼ï¼‰
uv run weather.py
```

**é¢„æœŸè¡Œä¸º**ï¼š
- æœåŠ¡å™¨å¯åŠ¨åä¼šç­‰å¾…æ¥è‡ªMCPå®¢æˆ·ç«¯çš„æ¶ˆæ¯
- ä¸ä¼šæœ‰å¯è§è¾“å‡ºï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼ˆæœåŠ¡å™¨åœ¨ç›‘å¬STDIOè¾“å…¥ï¼‰
- æŒ‰ `Ctrl+C` å¯ä»¥åœæ­¢æœåŠ¡å™¨

**è¿™ä¸€æ­¥çš„ä½œç”¨**ï¼š
- âœ… éªŒè¯ä»£ç è¯­æ³•æ­£ç¡®
- âœ… ç¡®è®¤ä¾èµ–åº“æ­£å¸¸åŠ è½½
- âœ… æ£€æŸ¥æœåŠ¡å™¨èƒ½å¤Ÿæ­£å¸¸å¯åŠ¨
- âœ… ä¸ºä¸‹ä¸€æ­¥çš„Claudeé…ç½®åšå‡†å¤‡

**Step 4: é…ç½®Claude Code**

```bash
# åœ¨å½“å‰é¡¹ç›®ä¸­æ·»åŠ MCPæœåŠ¡å™¨
claude mcp add weather -- uv run weather.py

# éªŒè¯é…ç½®
claude mcp list

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
claude mcp get weather
```

**Step 5: æµ‹è¯•æ•ˆæœ**

åœ¨Claudeä¸­æµ‹è¯•ä»¥ä¸‹é—®é¢˜ï¼š

1. **å¤©æ°”é¢„æŠ¥æŸ¥è¯¢**ï¼š
   "è¨å…‹æ‹‰é—¨æ‰˜çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"ï¼ˆçº¬åº¦38.5816ï¼Œç»åº¦-121.4944ï¼‰

2. **é¢„è­¦ä¿¡æ¯æŸ¥è¯¢**ï¼š
   "å¾·å…‹è¨æ–¯å·æœ‰ä»€ä¹ˆå¤©æ°”é¢„è­¦å—ï¼Ÿ"

Claudeä¼šè‡ªåŠ¨ï¼š
- è¯†åˆ«éœ€è¦å¤©æ°”æŸ¥è¯¢åŠŸèƒ½
- é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼ˆget_forecast æˆ– get_alertsï¼‰
- è°ƒç”¨ç¾å›½å›½å®¶æ°”è±¡å±€API
- è¿”å›æ ¼å¼åŒ–çš„å¤©æ°”ä¿¡æ¯

#### æ ¸å¿ƒå­¦ä¹ ç‚¹
- **è£…é¥°å™¨ `@mcp.tool()`**ï¼šå°†å¼‚æ­¥å‡½æ•°å˜æˆMCPå·¥å…·
- **ç±»å‹æ³¨è§£**ï¼šæ”¯æŒå¤šç§å‚æ•°ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æµ®ç‚¹æ•°ï¼‰
- **é”™è¯¯å¤„ç†**ï¼šAPIè°ƒç”¨çš„å®¹é”™æœºåˆ¶
- **å¼‚æ­¥æ”¯æŒ**ï¼šå¤„ç†ç½‘ç»œè¯·æ±‚çš„æœ€ä½³å®è·µ

### 4.2 è¿›é˜¶å®è·µï¼šå®Œæ•´MCPæœåŠ¡å™¨

#### å®é™…é¡¹ç›®æ¡ˆä¾‹ï¼šæ¡Œé¢txtæ–‡ä»¶ç®¡ç†å™¨

åŸºäºå‰é¢çš„åŸºç¡€ç‰ˆæœ¬ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…å«Toolsã€Resourcesã€Promptsçš„å®Œæ•´MCPæœåŠ¡å™¨ï¼š

**å®Œæ•´åŠŸèƒ½æ¸…å•**ï¼š
- **4ä¸ªå·¥å…·**ï¼šç»Ÿè®¡æ–‡ä»¶ã€åˆ—å‡ºæ–‡ä»¶ã€æŸ¥æ‰¾æ–‡ä»¶ã€è·å–ç³»ç»Ÿä¿¡æ¯
- **2ä¸ªèµ„æº**ï¼šç³»ç»Ÿä¿¡æ¯å’Œæ–‡ä»¶åˆ—è¡¨èµ„æº
- **2ä¸ªæç¤ºæ¨¡æ¿**ï¼šæ–‡ä»¶åˆ†æå’Œæ¸…ç†å»ºè®®

**æ ¸å¿ƒæ¶æ„**ï¼š
```python
from mcp.server.fastmcp import FastMCP
import os
import platform
from pathlib import Path

# åˆå§‹åŒ–MCPæœåŠ¡å™¨
mcp = FastMCP("æ¡Œé¢txtæ–‡ä»¶ç®¡ç†å™¨")

# === Tools å®ç° ===
@mcp.tool()
def count_desktop_txt_files() -> str:
    """ç»Ÿè®¡å½“å‰ç”¨æˆ·æ¡Œé¢ä¸Šçš„txtæ–‡ä»¶æ•°é‡"""
    # è·¨å¹³å°æ¡Œé¢è·¯å¾„æ£€æµ‹
    desktop_path = get_desktop_path()
    if not desktop_path.exists():
        return f"é”™è¯¯ï¼šæ— æ³•æ‰¾åˆ°æ¡Œé¢ç›®å½• {desktop_path}"
    
    txt_files = list(desktop_path.glob("*.txt"))
    return f"æ¡Œé¢txtæ–‡ä»¶æ•°é‡ï¼š{len(txt_files)} ä¸ª"

@mcp.tool()
def list_desktop_txt_files(include_details: bool = False) -> str:
    """è·å–æ¡Œé¢ä¸Šæ‰€æœ‰txtæ–‡ä»¶çš„åç§°åˆ—è¡¨"""
    # å®ç°ç»†èŠ‚...

# === Resources å®ç° ===  
@mcp.resource("desktop://system-info")
def get_system_resource():
    """æä¾›ç³»ç»Ÿä¿¡æ¯èµ„æº"""
    return json.dumps({
        "platform": platform.system(),
        "desktop_path": str(get_desktop_path()),
        "python_version": platform.python_version()
    })

# === Prompts å®ç° ===
@mcp.prompt()
def analyze_txt_files_prompt(file_count: int, file_list: str) -> str:
    """æ–‡ä»¶åˆ†ææç¤ºæ¨¡æ¿"""
    return f"""
è¯·åˆ†æä»¥ä¸‹æ¡Œé¢txtæ–‡ä»¶æƒ…å†µï¼š
- æ–‡ä»¶æ•°é‡ï¼š{file_count}
- æ–‡ä»¶åˆ—è¡¨ï¼š{file_list}

è¯·æä¾›ï¼š
1. æ–‡ä»¶ç»„ç»‡å»ºè®®
2. å¯èƒ½çš„æ¸…ç†æ–¹æ¡ˆ
3. å¤‡ä»½å»ºè®®
"""
```

**é…ç½®å’Œä½¿ç”¨**ï¼š
```bash
# æ·»åŠ åˆ°Claude Code
claude mcp add desktop-txt-manager -- python desktop_txt_manager_full.py

# æµ‹è¯•å„ç§åŠŸèƒ½
# Tools: "ç»Ÿè®¡æ¡Œé¢txtæ–‡ä»¶"
# Resources: "@desktop://system-info"  
# Prompts: "/analyze-txt-files"
```

**å®é™…æ•ˆæœæ¼”ç¤º**ï¼š
1. **å·¥å…·è°ƒç”¨**ï¼šAIè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å·¥å…·æ‰§è¡Œä»»åŠ¡
2. **èµ„æºè®¿é—®**ï¼šAIè·å–ç³»ç»Ÿä¿¡æ¯æä¾›å‡†ç¡®å»ºè®®
3. **æç¤ºæ¨¡æ¿**ï¼šAIä½¿ç”¨æ ‡å‡†åŒ–æ¨¡æ¿ç”Ÿæˆä¸“ä¸šåˆ†æ

è¿™ä¸ªæ¡ˆä¾‹å±•ç¤ºäº†MCPçš„æ ¸å¿ƒä»·å€¼ï¼š**ä¸€æ¬¡å¼€å‘ï¼Œå¤šç§èƒ½åŠ›ï¼Œæ ‡å‡†åŒ–äº¤äº’**ã€‚

---

## 5. MCP å®‰è£…é…ç½®æŒ‡å—

### 5.1 claude mcp å‘½ä»¤æ¦‚è¿°

#### æ ¸å¿ƒå‘½ä»¤ä»‹ç»

`claude mcp` æ˜¯ Claude Code æä¾›çš„ä¸“ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºç®¡ç† MCP æœåŠ¡å™¨çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸã€‚

**å‘½ä»¤ç»“æ„**ï¼š
```bash
claude mcp [å­å‘½ä»¤] [é€‰é¡¹] [å‚æ•°...]
```

**ä¸»è¦å­å‘½ä»¤**ï¼š
```bash
claude mcp add        # æ·»åŠ MCPæœåŠ¡å™¨
claude mcp list       # åˆ—å‡ºæ‰€æœ‰é…ç½®çš„æœåŠ¡å™¨
claude mcp get        # æŸ¥çœ‹ç‰¹å®šæœåŠ¡å™¨è¯¦æƒ…
claude mcp remove     # åˆ é™¤MCPæœåŠ¡å™¨
claude mcp serve      # å°†Claude Codeä½œä¸ºMCPæœåŠ¡å™¨è¿è¡Œ
claude mcp reset-project-choices  # é‡ç½®é¡¹ç›®èŒƒå›´çš„æ‰¹å‡†é€‰æ‹©
```

#### å¸¸ç”¨å‘½ä»¤å‚æ•°è¯¦è§£

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ï¼šå‘½ä»¤å‚æ•°å®Œæ•´è¯´æ˜</summary>

**claude mcp add å‚æ•°è¯­æ³•**ï¼š
```bash
# STDIOä¼ è¾“ï¼ˆæœ¬åœ°å‘½ä»¤ï¼‰
claude mcp add [é€‰é¡¹] <name> <command> [args...]

# è¿œç¨‹ä¼ è¾“ï¼ˆSSE/HTTPï¼‰
claude mcp add --transport <type> [é€‰é¡¹] <name> <url>
```

**é€šç”¨é€‰é¡¹**ï¼š
```bash
-s, --scope <scope>          # è®¾ç½®èŒƒå›´ï¼šlocalï¼ˆé»˜è®¤ï¼‰/project/user
-e, --env <key=value>        # è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ”¯æŒå¤šä¸ª-eé€‰é¡¹
--transport <type>           # ä¼ è¾“ç±»å‹ï¼šstdioï¼ˆé»˜è®¤ï¼‰/sse/http
```

**STDIOä¼ è¾“å‚æ•°ï¼ˆæœ¬åœ°æœåŠ¡å™¨ï¼‰**ï¼š
```bash
<name>                      # æœåŠ¡å™¨åç§°ï¼ˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼‰
<command>                   # æœåŠ¡å™¨å¯åŠ¨å‘½ä»¤
[args...]                   # å‘½ä»¤è¡Œå‚æ•°
```

**è¿œç¨‹ä¼ è¾“å‚æ•°ï¼ˆSSE/HTTPï¼‰**ï¼š
```bash
<name>                      # æœåŠ¡å™¨åç§°
<url>                       # æœåŠ¡å™¨URLç«¯ç‚¹
--header <key=value>        # HTTPè¯·æ±‚å¤´ï¼ˆä»…HTTPä¼ è¾“ï¼‰
```

**å®é™…ä½¿ç”¨ç¤ºä¾‹**ï¼š

**1. STDIOæœåŠ¡å™¨é…ç½®ç¤ºä¾‹**ï¼š
```bash
# åŸºæœ¬æ–‡ä»¶ç³»ç»Ÿè®¿é—®
claude mcp add filesystem -- npx -y @modelcontextprotocol/server-filesystem ~/Documents

# å¸¦ç¯å¢ƒå˜é‡çš„GitHubé›†æˆ
claude mcp add github \
  --env GITHUB_TOKEN=ghp_xxxxxxxxxxxx \
  -- npx -y @modelcontextprotocol/server-github

# å¤šç¯å¢ƒå˜é‡é…ç½®
claude mcp add database \
  --env DB_HOST=localhost \
  --env DB_PORT=5432 \
  --env DB_NAME=myapp \
  -- python -m database_mcp_server

# è‡ªå®šä¹‰Pythonè„šæœ¬
claude mcp add weather \
  --scope user \
  -- uv run weather.py

# é¡¹ç›®èŒƒå›´é…ç½®ï¼ˆå›¢é˜Ÿå…±äº«ï¼‰
claude mcp add team-tools \
  --scope project \
  --env API_KEY=${API_KEY} \
  -- python scripts/team_server.py
```

**2. SSEæœåŠ¡å™¨é…ç½®ç¤ºä¾‹**ï¼š
```bash
# Linearé¡¹ç›®ç®¡ç†
claude mcp add --transport sse linear https://mcp.linear.app/sse

# Asanaä»»åŠ¡ç®¡ç†
claude mcp add --transport sse asana https://mcp.asana.com/sse

# ç”¨æˆ·èŒƒå›´SSEæœåŠ¡å™¨
claude mcp add --transport sse --scope user \
  monday https://mcp.monday.com/sse
```

**3. HTTPæœåŠ¡å™¨é…ç½®ç¤ºä¾‹**ï¼š
```bash
# Sentryé”™è¯¯ç›‘æ§
claude mcp add --transport http sentry https://mcp.sentry.dev/mcp

# å¸¦è®¤è¯å¤´çš„HTTPæœåŠ¡å™¨
claude mcp add --transport http \
  --header "Authorization=Bearer ${API_TOKEN}" \
  custom-api https://api.example.com/mcp

# Socketå®‰å…¨åˆ†æ
claude mcp add --transport http socket https://mcp.socket.dev/
```

**4. ä¸åŒèŒƒå›´çš„å®é™…åº”ç”¨**ï¼š
```bash
# æœ¬åœ°èŒƒå›´ï¼šä¸ªäººå®éªŒå’Œæ•æ„Ÿé…ç½®
claude mcp add --scope local experimental-server -- python test_server.py

# é¡¹ç›®èŒƒå›´ï¼šå›¢é˜Ÿå…±äº«å·¥å…·ï¼ˆå­˜å‚¨åœ¨.mcp.jsonï¼‰
claude mcp add --scope project shared-db \
  --env DATABASE_URL=${PROJECT_DATABASE_URL} \
  -- npx -y @team/database-mcp

# ç”¨æˆ·èŒƒå›´ï¼šè·¨é¡¹ç›®å¼€å‘å·¥å…·
claude mcp add --scope user dev-tools \
  --env OPENAI_API_KEY=${OPENAI_API_KEY} \
  -- python ~/.local/bin/dev_assistant.py
```

**5. é«˜çº§é…ç½®æŠ€å·§**ï¼š
```bash
# ä½¿ç”¨ç¯å¢ƒå˜é‡æ‰©å±•
claude mcp add flexible-server \
  --env CONFIG_PATH=${PROJECT_ROOT}/config.yaml \
  --env LOG_LEVEL=${LOG_LEVEL:-info} \
  -- ${PYTHON_PATH:-python3} server.py

# å¤æ‚å‚æ•°ä¼ é€’
claude mcp add data-processor \
  --env API_TIMEOUT=30 \
  --env BATCH_SIZE=100 \
  -- npx -y @company/data-processor \
  --config config.json \
  --workers 4
```

**claude mcp list å‚æ•°**ï¼š
```bash
claude mcp list [é€‰é¡¹]

-s, --scope <scope>         # ä»…æ˜¾ç¤ºç‰¹å®šèŒƒå›´çš„æœåŠ¡å™¨
--format <format>           # è¾“å‡ºæ ¼å¼ï¼štableï¼ˆé»˜è®¤ï¼‰/json
```

**claude mcp remove å‚æ•°**ï¼š
```bash
claude mcp remove [é€‰é¡¹] <name>

-s, --scope <scope>         # æŒ‡å®šè¦åˆ é™¤çš„æœåŠ¡å™¨èŒƒå›´
--force                     # å¼ºåˆ¶åˆ é™¤ï¼Œæ— éœ€ç¡®è®¤
```

**claude mcp serve å‚æ•°**ï¼š
```bash
claude mcp serve [é€‰é¡¹]

--stdio                     # STDIOæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
--http                      # HTTPæ¨¡å¼
--host <host>               # HTTPç›‘å¬ä¸»æœºï¼ˆé»˜è®¤ï¼šlocalhostï¼‰
--port <port>               # HTTPç›‘å¬ç«¯å£ï¼ˆé»˜è®¤ï¼š3000ï¼‰
```

**å¯¼å…¥å¯¼å‡ºå‘½ä»¤**ï¼š
```bash
# ä»JSONå¯¼å…¥
claude mcp add-from-json <file-or-url>

# ä»Claude Desktopå¯¼å…¥  
claude mcp import-from-claude-desktop [é€‰é¡¹]
--server <name>             # ä»…å¯¼å…¥ç‰¹å®šæœåŠ¡å™¨
--preserve-scope            # ä¿æŒåŸæœ‰ä½œç”¨åŸŸè®¾ç½®
```

</details>

### 5.2 é…ç½®ç®¡ç†åŸºç¡€

#### MCP å®‰è£…èŒƒå›´è¯¦è§£

MCP æœåŠ¡å™¨å¯ä»¥åœ¨ä¸‰ä¸ªä¸åŒçš„èŒƒå›´çº§åˆ«é…ç½®ï¼Œäº†è§£è¿™äº›èŒƒå›´æœ‰åŠ©äºé€‰æ‹©æœ€ä½³é…ç½®æ–¹å¼ï¼š

**æœ¬åœ°èŒƒå›´ï¼ˆLocalï¼‰**ï¼š
- **å­˜å‚¨ä½ç½®**ï¼šé¡¹ç›®ç‰¹å®šç”¨æˆ·è®¾ç½®  
- **é€‚ç”¨åœºæ™¯**ï¼šä¸ªäººå¼€å‘ã€å®éªŒé…ç½®ã€æ•æ„Ÿå‡­æ®
- **è®¿é—®æƒé™**ï¼šä»…å½“å‰é¡¹ç›®ç›®å½•å¯ç”¨
- **å‘½ä»¤ç¤ºä¾‹**ï¼š`claude mcp add -s local my-server`

**é¡¹ç›®èŒƒå›´ï¼ˆProjectï¼‰**ï¼š
- **å­˜å‚¨ä½ç½®**ï¼šé¡¹ç›®æ ¹ç›®å½•çš„ `.mcp.json` æ–‡ä»¶
- **é€‚ç”¨åœºæ™¯**ï¼šå›¢é˜Ÿå…±äº«ã€é¡¹ç›®ç‰¹å®šå·¥å…·ã€ç‰ˆæœ¬æ§åˆ¶
- **è®¿é—®æƒé™**ï¼šæ‰€æœ‰å›¢é˜Ÿæˆå‘˜ï¼ˆéœ€è¦æ‰¹å‡†ï¼‰
- **å‘½ä»¤ç¤ºä¾‹**ï¼š`claude mcp add -s project team-tools`

**ç”¨æˆ·èŒƒå›´ï¼ˆUserï¼‰**ï¼š
- **å­˜å‚¨ä½ç½®**ï¼šç”¨æˆ·çº§é…ç½®æ–‡ä»¶
- **é€‚ç”¨åœºæ™¯**ï¼šä¸ªäººå·¥å…·ã€å¼€å‘ç¯å¢ƒã€è·¨é¡¹ç›®æœåŠ¡
- **è®¿é—®æƒé™**ï¼šç”¨æˆ·æ‰€æœ‰é¡¹ç›®å¯ç”¨
- **å‘½ä»¤ç¤ºä¾‹**ï¼š`claude mcp add -s user dev-tools`

#### ç¯å¢ƒå˜é‡æ‰©å±•æ”¯æŒ

Claude Code åœ¨é…ç½®æ–‡ä»¶ä¸­æ”¯æŒç¯å¢ƒå˜é‡æ‰©å±•ï¼Œæä¾›çµæ´»çš„é…ç½®ç®¡ç†ï¼š

**æ”¯æŒè¯­æ³•**ï¼š
```bash
${VAR}              # ç¯å¢ƒå˜é‡VARçš„å€¼
${VAR:-default}     # VARçš„å€¼ï¼Œå¦‚æœæœªè®¾ç½®åˆ™ä½¿ç”¨default
```

**å¯æ‰©å±•ä½ç½®**ï¼š
- `command` - æœåŠ¡å™¨å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„
- `args` - å‘½ä»¤è¡Œå‚æ•°  
- `env` - ç¯å¢ƒå˜é‡
- `url` - SSE/HTTPæœåŠ¡å™¨URL  
- `headers` - èº«ä»½éªŒè¯Headers

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š
```json
{
  "mcpServers": {
    "my-server": {
      "command": "${PYTHON_PATH:-python3}",
      "args": ["${PROJECT_ROOT}/server.py"],
      "env": {
        "API_KEY": "${API_KEY}",
        "LOG_LEVEL": "${LOG_LEVEL:-info}"
      }
    }
  }
}
```

#### èŒƒå›´ä¼˜å…ˆçº§å’Œå†²çªè§£å†³

å½“å¤šä¸ªèŒƒå›´ä¸­å­˜åœ¨åŒåæœåŠ¡å™¨æ—¶ï¼Œç³»ç»ŸæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§è§£å†³å†²çªï¼š

```
Local (æœ¬åœ°) > Project (é¡¹ç›®) > User (ç”¨æˆ·)
```

è¿™ç¡®ä¿ä¸ªäººé…ç½®å¯ä»¥è¦†ç›–å…±äº«é…ç½®ï¼Œæä¾›æœ€å¤§çš„çµæ´»æ€§ã€‚

### 5.3 å®‰è£…æ–¹å¼ä¸€ï¼šClaude Desktopå¯¼å…¥

**é€‚ç”¨åœºæ™¯**ï¼šå·²åœ¨ Claude Desktop ä¸­é…ç½®äº† MCP æœåŠ¡å™¨ï¼Œå¸Œæœ›åœ¨ Claude Code ä¸­å¤ç”¨

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ï¼šClaude Desktopå¯¼å…¥è¯¦ç»†æ­¥éª¤</summary>

**Step 1: æ£€æŸ¥ Claude Desktop é…ç½®**
```bash
# æŸ¥çœ‹ Claude Desktop é…ç½®æ–‡ä»¶ä½ç½®
# macOS: ~/Library/Application Support/Claude/claude_desktop_config.json
# Windows: %APPDATA%/Claude/claude_desktop_config.json

# æ£€æŸ¥ç°æœ‰é…ç½®
cat ~/Library/Application\ Support/Claude/claude_desktop_config.json | jq .mcpServers
```

**Step 2: å¯¼å…¥æ‰€æœ‰é…ç½®**
```bash
# å¯¼å…¥æ‰€æœ‰Claude Desktopçš„MCPé…ç½®
claude mcp import-from-claude-desktop

# æŸ¥çœ‹å¯¼å…¥ç»“æœ
claude mcp list
```

**Step 3: é€‰æ‹©æ€§å¯¼å…¥**
```bash
# ä»…å¯¼å…¥ç‰¹å®šæœåŠ¡å™¨
claude mcp import-from-claude-desktop --server filesystem --server github

# å¯¼å…¥æ—¶ä¿æŒåŸæœ‰ä½œç”¨åŸŸè®¾ç½®
claude mcp import-from-claude-desktop --preserve-scope
```

**Step 4: éªŒè¯å¯¼å…¥ç»“æœ**
```bash
# åˆ—å‡ºæ‰€æœ‰å¯¼å…¥çš„æœåŠ¡å™¨
claude mcp list

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡å™¨é…ç½®
claude mcp get filesystem

# åœ¨Claude Codeä¸­æµ‹è¯•
/mcp
```

</details>

### 5.4 å®‰è£…æ–¹å¼äºŒï¼šJSONé…ç½®æ–¹å¼

**é€‚ç”¨åœºæ™¯**ï¼šæ‰¹é‡é…ç½®ã€å›¢é˜Ÿåä½œã€é…ç½®æ–‡ä»¶ç®¡ç†

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ï¼šJSONé…ç½®è¯¦ç»†æ–¹æ³•</summary>

**æ–¹æ³•ä¸€ï¼šä»JSONæ–‡ä»¶å¯¼å…¥**
```bash
# ä»æœ¬åœ°JSONæ–‡ä»¶æ·»åŠ é…ç½®
claude mcp add-from-json ./mcp-config.json

# ä»è¿œç¨‹URLæ·»åŠ é…ç½®
claude mcp add-from-json https://example.com/team-mcp-config.json
```

**æ–¹æ³•äºŒï¼šç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶**

**å…¨å±€é…ç½®æ–‡ä»¶ä½ç½®**ï¼š
```bash
# macOS/Linux
~/.claude.json

# Windows  
%USERPROFILE%\.claude.json
```

**é¡¹ç›®é…ç½®æ–‡ä»¶**ï¼š
```bash
# é¡¹ç›®æ ¹ç›®å½•
.mcp.json
```

**æ ‡å‡†JSONæ ¼å¼**ï¼š
```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-filesystem", "${HOME}/Documents"],
      "env": {}
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_TOKEN": "${GITHUB_TOKEN}"
      }
    },
    "sentry": {
      "transport": "http",
      "url": "https://mcp.sentry.dev/mcp",
      "headers": {
        "Authorization": "Bearer ${SENTRY_TOKEN}"
      }
    }
  }
}
```

**å›¢é˜Ÿåä½œé…ç½®ç¤ºä¾‹**ï¼š
```json
{
  "mcpServers": {
    "team-database": {
      "command": "${PROJECT_PYTHON_PATH:-python}",
      "args": ["-m", "custom_mcp_server"],
      "env": {
        "DATABASE_URL": "${DATABASE_URL}",
        "API_KEY": "${API_KEY:-development-key}"
      }
    },
    "shared-tools": {
      "command": "${HOME}/.local/bin/team-tools",
      "args": ["--config", "${PROJECT_ROOT}/config.yaml"],
      "env": {
        "TEAM_ID": "${TEAM_ID}",
        "ENV": "${ENVIRONMENT:-development}"
      }
    }
  }
}
```

**é…ç½®åé‡å¯Claude Codeä½¿é…ç½®ç”Ÿæ•ˆ**

</details>

### 5.5 å®‰è£…æ–¹å¼ä¸‰ï¼šå‘½ä»¤è¡Œæ–¹å¼

**é€‚ç”¨åœºæ™¯**ï¼šå¿«é€Ÿå®‰è£…ã€å•ä¸ªæœåŠ¡å™¨é…ç½®ã€è„šæœ¬è‡ªåŠ¨åŒ–

#### 5.5.1 STDIOæœåŠ¡å™¨ï¼ˆæœ¬åœ°è¿›ç¨‹ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦ç›´æ¥ç³»ç»Ÿè®¿é—®æˆ–è‡ªå®šä¹‰è„šæœ¬çš„å·¥å…·

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ï¼šSTDIOæœåŠ¡å™¨é…ç½®è¯¦è§£</summary>

**åŸºæœ¬è¯­æ³•**ï¼š
```bash
claude mcp add [é€‰é¡¹] <name> <command> [args...]
```

**å¸¸ç”¨STDIOæœåŠ¡å™¨ç¤ºä¾‹**ï¼š
```bash
# æ–‡ä»¶ç³»ç»Ÿè®¿é—®ï¼ˆæœ€å¸¸ç”¨ï¼‰
claude mcp add filesystem -- npx -y @modelcontextprotocol/server-filesystem ~/Documents

# GitHubé›†æˆï¼ˆéœ€è¦Tokenï¼‰
claude mcp add github --env GITHUB_TOKEN=ghp_xxxx -- npx -y @modelcontextprotocol/server-github

# Airtableæ•°æ®åº“
claude mcp add airtable --env AIRTABLE_API_KEY=key123 -- npx -y airtable-mcp-server

# ClickUpé¡¹ç›®ç®¡ç†
claude mcp add clickup --env CLICKUP_API_KEY=pk_123 --env CLICKUP_TEAM_ID=456 -- npx -y @hauptsache.net/clickup-mcp
```

**ä¸åŒèŒƒå›´çš„é…ç½®**ï¼š
```bash
# æœ¬åœ°èŒƒå›´ï¼ˆé»˜è®¤ï¼‰- ä»…å½“å‰é¡¹ç›®
claude mcp add -s local my-server -- npx -y @example/server

# é¡¹ç›®èŒƒå›´ - å›¢é˜Ÿå…±äº«ï¼Œå­˜å‚¨åœ¨.mcp.json
claude mcp add -s project shared-db -- npx -y @team/database-server

# ç”¨æˆ·èŒƒå›´ - è·¨é¡¹ç›®å¯ç”¨
claude mcp add -s user dev-tools -- npx -y @personal/dev-server
```

</details>

#### 5.5.2 SSEæœåŠ¡å™¨ï¼ˆå®æ—¶æµè¿æ¥ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦å®æ—¶æ›´æ–°çš„äº‘æœåŠ¡

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ï¼šSSEæœåŠ¡å™¨é…ç½®è¯¦è§£</summary>

**åŸºæœ¬è¯­æ³•**ï¼š
```bash
claude mcp add --transport sse [é€‰é¡¹] <name> <url>
```

**å®˜æ–¹SSEæœåŠ¡å™¨ç¤ºä¾‹**ï¼š
```bash
# Asanaå·¥ä½œç©ºé—´é¡¹ç›®ç®¡ç†
claude mcp add --transport sse asana https://mcp.asana.com/sse

# Atlassian Jiraå’ŒConfluence
claude mcp add --transport sse atlassian https://mcp.atlassian.com/v1/sse

# Linearé—®é¢˜è·Ÿè¸ª
claude mcp add --transport sse linear https://mcp.linear.app/sse

# Monday.comçœ‹æ¿ç®¡ç†
claude mcp add --transport sse monday https://mcp.monday.com/sse

# Plaidé“¶è¡Œæ•°æ®
claude mcp add --transport sse plaid https://api.dashboard.plaid.com/mcp/sse

# Squareæ”¯ä»˜API
claude mcp add --transport sse square https://mcp.squareup.com/sse

# InVideoè§†é¢‘åˆ›å»º
claude mcp add --transport sse invideo https://mcp.invideo.io/sse
```

**å¸¦ä½œç”¨åŸŸçš„SSEé…ç½®**ï¼š
```bash
# ç”¨æˆ·èŒƒå›´SSEæœåŠ¡å™¨
claude mcp add -s user --transport sse asana https://mcp.asana.com/sse

# é¡¹ç›®èŒƒå›´SSEæœåŠ¡å™¨  
claude mcp add -s project --transport sse linear https://mcp.linear.app/sse
```

</details>

#### 5.5.3 HTTPæœåŠ¡å™¨ï¼ˆæ ‡å‡†è¯·æ±‚å“åº”ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šREST APIå’Œæ ‡å‡†WebæœåŠ¡

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ï¼šHTTPæœåŠ¡å™¨é…ç½®è¯¦è§£</summary>

**åŸºæœ¬è¯­æ³•**ï¼š
```bash
claude mcp add --transport http [é€‰é¡¹] <name> <url>
```

**å®˜æ–¹HTTPæœåŠ¡å™¨ç¤ºä¾‹**ï¼š
```bash
# Sentryé”™è¯¯ç›‘æ§
claude mcp add --transport http sentry https://mcp.sentry.dev/mcp

# Socketä¾èµ–å®‰å…¨åˆ†æ
claude mcp add --transport http socket https://mcp.socket.dev/

# HuggingFace AIæ¨¡å‹
claude mcp add --transport http hugging-face https://huggingface.co/mcp

# Jamè°ƒè¯•è®°å½•
claude mcp add --transport http jam https://mcp.jam.dev/mcp

# Intercomå®¢æˆ·æœåŠ¡
claude mcp add --transport http intercom https://mcp.intercom.com/mcp

# Notionæ–‡æ¡£ç®¡ç†
claude mcp add --transport http notion https://mcp.notion.com/mcp

# Boxä¼ä¸šå†…å®¹
claude mcp add --transport http box https://mcp.box.com/

# Firefliesä¼šè®®åˆ†æ
claude mcp add --transport http fireflies https://api.fireflies.ai/mcp

# HubSpot CRM
claude mcp add --transport http hubspot https://mcp.hubspot.com/anthropic

# PayPalæ”¯ä»˜
claude mcp add --transport http paypal https://mcp.paypal.com/mcp

# Stripeè´¢åŠ¡
claude mcp add --transport http stripe https://mcp.stripe.com

# Figmaè®¾è®¡ï¼ˆéœ€è¦æœ¬åœ°Dev ModeæœåŠ¡å™¨ï¼‰
claude mcp add --transport http figma-dev-mode-mcp-server http://127.0.0.1:3845/mcp

# Canvaè®¾è®¡
claude mcp add --transport http canva https://mcp.canva.com/mcp

# Netlifyéƒ¨ç½²
claude mcp add --transport http netlify https://netlify-mcp.netlify.app/mcp

# Vercelé¡¹ç›®ç®¡ç†
claude mcp add --transport http vercel https://mcp.vercel.com/

# Stytchè®¤è¯
claude mcp add --transport http stytch http://mcp.stytch.dev/mcp
```

**éœ€è¦è®¤è¯çš„HTTPæœåŠ¡å™¨**ï¼š
```bash
# è®¸å¤šHTTPæœåŠ¡å™¨éœ€è¦OAuthè®¤è¯
# Claude Codeä¼šè‡ªåŠ¨å¤„ç†OAuthæµç¨‹ï¼Œæ‰“å¼€æµè§ˆå™¨è¿›è¡Œæˆæƒ
claude mcp add --transport http github-enterprise https://api.github.company.com/mcp
```

</details>

#### é…ç½®éªŒè¯å’Œç®¡ç†

**éªŒè¯é…ç½®**ï¼š
```bash
# åˆ—å‡ºæ‰€æœ‰é…ç½®çš„æœåŠ¡å™¨
claude mcp list

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡å™¨è¯¦æƒ…
claude mcp get server-name

# åœ¨Claude Codeä¸­æ£€æŸ¥çŠ¶æ€
/mcp
```

**é…ç½®ç®¡ç†**ï¼š
```bash
# åˆ é™¤æœåŠ¡å™¨ï¼ˆæŒ‡å®šèŒƒå›´ï¼‰
claude mcp remove server-name -s local
claude mcp remove team-tools -s project
claude mcp remove dev-tools -s user

# é‡ç½®é¡¹ç›®èŒƒå›´æ‰¹å‡†
claude mcp reset-project-choices
```

**ä½¿ç”¨MCPåŠŸèƒ½**ï¼š
```bash
# å¼•ç”¨MCPèµ„æº
@resource-name
@server-name/resource-path

# ä½¿ç”¨MCPæç¤ºå‘½ä»¤
/prompt-name
/code-review "review this function"

# åˆ—å‡ºå¯ç”¨åŠŸèƒ½
/mcp resources
/mcp prompts
```

---

## 6. MCPç”Ÿæ€æ€»è§ˆ

### çƒ­é—¨MCPé¡¹ç›®æ¨è

#### å®˜æ–¹ç»´æŠ¤é¡¹ç›®

| é¡¹ç›®åç§° | åŠŸèƒ½æè¿° | ç»´æŠ¤çŠ¶æ€ |
|---------|---------|---------|
| [**filesystem**](https://github.com/modelcontextprotocol/servers/tree/main/src/filesystem) | æ–‡ä»¶ç³»ç»Ÿæ“ä½œ | å®˜æ–¹ç»´æŠ¤ |
| [**brave-search**](https://github.com/modelcontextprotocol/servers/tree/main/src/brave-search) | Braveæœç´¢å¼•æ“ | å®˜æ–¹ç»´æŠ¤ |
| [**slack**](https://github.com/modelcontextprotocol/servers/tree/main/src/slack) | Slackæ¶ˆæ¯é›†æˆ | å®˜æ–¹ç»´æŠ¤ |
| [**postgres**](https://github.com/modelcontextprotocol/servers/tree/main/src/postgres) | PostgreSQLæ•°æ®åº“ | å®˜æ–¹ç»´æŠ¤ |
| [**git**](https://github.com/modelcontextprotocol/servers/tree/main/src/git) | Gitç‰ˆæœ¬æ§åˆ¶ | å®˜æ–¹ç»´æŠ¤ |

#### ç¤¾åŒºçƒ­é—¨é¡¹ç›®

| é¡¹ç›®åç§° | åŠŸèƒ½æè¿° | Stars | ç±»å‹ |
|---------|---------|-------|------|
| [**playwright**](https://github.com/browserbase/mcp-server-playwright) | æµè§ˆå™¨è‡ªåŠ¨åŒ– | 19k+ | ç½‘é¡µæ“ä½œ |
| [**github**](https://github.com/github/gh-mcp) | GitHubå®˜æ–¹æœåŠ¡å™¨ | 22k+ | ä»£ç ç®¡ç† |
| [**aws**](https://github.com/aws/mcp-server-aws) | AWSäº‘æœåŠ¡é›†æˆ | 6.2k+ | äº‘æœåŠ¡ |
| [**browser-mcp**](https://github.com/UI-TARS/browser-mcp) | æµè§ˆå™¨æ§åˆ¶ | 4.1k+ | ç½‘é¡µäº¤äº’ |
| [**whatsapp**](https://github.com/semioz/whatsapp-mcp-server) | WhatsAppæ¶ˆæ¯ | 4.8k+ | æ¶ˆæ¯é€šä¿¡ |

#### å·¥å…·ä¸æœåŠ¡åˆ†ç±»

| é¡¹ç›®åç§° | åŠŸèƒ½æè¿° | é€‚ç”¨åœºæ™¯ |
|---------|---------|---------|
| [**linear**](https://github.com/abdulrahman305/mcp-server-linear) | Linearé¡¹ç›®ç®¡ç† | ä»»åŠ¡è·Ÿè¸ªã€é¡¹ç›®åä½œ |
| [**jira**](https://github.com/joshuarileydev/mcp-server-jira) | Jiraé›†æˆ | Issueç®¡ç†ã€æ•æ·å¼€å‘ |
| [**docker**](https://github.com/donghyun-chae/mcp-server-docker) | Dockerå®¹å™¨ç®¡ç† | å®¹å™¨æ“ä½œã€éƒ¨ç½²è‡ªåŠ¨åŒ– |
| [**salesforce**](https://github.com/nabeelkausari/mcp-server-salesforce) | CRMç³»ç»Ÿé›†æˆ | å®¢æˆ·å…³ç³»ç®¡ç† |
| [**notion**](https://github.com/v-3/notion-mcp-server) | NotionçŸ¥è¯†åº“ | æ–‡æ¡£ç®¡ç†ã€çŸ¥è¯†åä½œ |
| [**gmail**](https://github.com/adhikasp/mcp-server-gmail) | Gmailé‚®ä»¶æœåŠ¡ | é‚®ä»¶è‡ªåŠ¨åŒ–å¤„ç† |
| [**screenshot**](https://github.com/BrowserLoop/mcp-server-screenshot) | å±å¹•æˆªå›¾ | è‡ªåŠ¨æˆªå›¾ã€å›¾åƒåˆ†æ |
| [**sqlite**](https://github.com/modelcontextprotocol/servers/tree/main/src/sqlite) | SQLiteæ•°æ®åº“ | æœ¬åœ°æ•°æ®æŸ¥è¯¢ç®¡ç† |

### Claude Desktopå…¼å®¹æ€§

å·²éªŒè¯å…¼å®¹çš„MCPæœåŠ¡å™¨åŒ…æ‹¬ï¼š
- **æ–‡ä»¶æ“ä½œ**: filesystem, git, sqlite
- **ç½‘ç»œæœåŠ¡**: brave-search, fetch, slack  
- **æ•°æ®å¤„ç†**: postgres, memory, puppeteer

<details>
<summary>æŸ¥çœ‹Claude Desktopé…ç½®ç¤ºä¾‹</summary>

```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-filesystem", "/Users/username"]
    },
    "brave-search": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-brave-search"],
      "env": { "BRAVE_API_KEY": "your-api-key" }
    },
    "postgres": {
      "command": "npx", 
      "args": ["-y", "@modelcontextprotocol/server-postgres"],
      "env": { "POSTGRES_CONNECTION_STRING": "postgresql://user:pass@localhost/db" }
    }
  }
}
```

</details>

### ç”Ÿæ€å‘å±•ç°çŠ¶

#### å¢é•¿æ•°æ®

| æ—¶é—´ | é¡¹ç›®æ•°é‡ | å‘å±•é˜¶æ®µ |
|------|---------|---------|
| 2024å¹´11æœˆ | 10ä¸ª | Anthropicå‘å¸ƒ |
| 2024å¹´12æœˆ | 100ä¸ª | æ—©æœŸé‡‡ç”¨ |
| 2025å¹´01æœˆ | 500+ | ç¤¾åŒºçˆ†å‘ |
| 2025å¹´03æœˆ | 1000+ | ä¼ä¸šé‡‡ç”¨ |

#### ç¼–ç¨‹è¯­è¨€åˆ†å¸ƒ

| è¯­è¨€ | å æ¯” | é¡¹ç›®æ•° |
|------|------|-------|
| Python | 45% | 250+ |
| TypeScript/JavaScript | 35% | 200+ |
| Go | 12% | 60+ |
| Rust | 5% | 30+ |
| å…¶ä»– | 3% | 15+ |

### é¡¹ç›®é€‰æ‹©æŒ‡å—

#### è¯„ä¼°æ ‡å‡†

| æ ‡å‡† | é‡è¦æ€§ | è¯„ä¼°è¦ç‚¹ |
|------|-------|---------|
| æ´»è·ƒåº¦ | é«˜ | æ›´æ–°é¢‘ç‡ã€Issueå“åº” |
| æ–‡æ¡£è´¨é‡ | é«˜ | READMEã€ç¤ºä¾‹å®Œæ•´æ€§ |
| ç¤¾åŒºæ”¯æŒ | ä¸­ | Staræ•°ã€è´¡çŒ®è€…æ•°é‡ |
| åŠŸèƒ½åŒ¹é… | é«˜ | ä¸šåŠ¡éœ€æ±‚å¥‘åˆåº¦ |

#### å‘ç°èµ„æº

**å®˜æ–¹èµ„æº**ï¼š
- [Awesome MCP Servers](https://github.com/modelcontextprotocol/servers)
- [MCPå®˜ç½‘é¡¹ç›®åˆ—è¡¨](https://modelcontextprotocol.io/servers)

**ç¤¾åŒºèµ„æº**ï¼š
- GitHub Topic: `mcp-server`
- Reddit: r/ModelContextProtocol

---

## æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹å›é¡¾

1. **ä»€ä¹ˆæ˜¯MCP**ï¼šæ ‡å‡†åŒ–AIä¸å¤–éƒ¨å·¥å…·è¿æ¥çš„å¼€æ”¾åè®®
2. **å®Œæ•´æ¶æ„**ï¼šæœåŠ¡å™¨åŸè¯­ï¼ˆTools/Resources/Promptsï¼‰+ å®¢æˆ·ç«¯åŸè¯­ï¼ˆSampling/Elicitation/Loggingï¼‰+ AIå·¥å…·é€‰æ‹©æœºåˆ¶
3. **ä¸ºä»€ä¹ˆéœ€è¦**ï¼šè§£å†³Function Callå¹³å°ä¾èµ–å’Œé‡å¤å¼€å‘é—®é¢˜  
4. **å¦‚ä½•ä½¿ç”¨**ï¼šè£…é¥°å™¨ + é…ç½®æ–‡ä»¶åˆ›å»ºå¼ºå¤§å·¥å…·ï¼Œæ”¯æŒè·¨å¹³å°æ ‡å‡†åŒ–äº¤äº’
5. **ç”Ÿæ€ç°çŠ¶**ï¼š1000+é¡¹ç›®ï¼Œä¼ä¸šçº§åº”ç”¨å¿«é€Ÿè½åœ°

### MCPçš„ä»·å€¼

MCPå¸¦æ¥çš„ä¸åªæ˜¯æŠ€æœ¯åè®®ï¼Œæ›´æ˜¯AIåº”ç”¨å¼€å‘èŒƒå¼çš„è½¬å˜ï¼š

- **ä»å¹³å°ç»‘å®šåˆ°æ ‡å‡†å¼€æ”¾**
- **ä»é‡å¤å¼€å‘åˆ°ç”Ÿæ€å…±äº«**  
- **ä»æ•°æ®ä¸Šäº‘åˆ°æœ¬åœ°å®‰å…¨**
- **ä»å‰²è£‚å·¥å…·åˆ°ç»Ÿä¸€æ¥å£**

æœªæ¥ï¼Œæ¯ä¸ªAIåº”ç”¨éƒ½å°†æ”¯æŒMCPï¼Œæ¯ä¸ªå¼€å‘è€…éƒ½èƒ½è½»æ¾ä¸ºAIèµ‹èƒ½ã€‚è¿™æ˜¯å¼€æ”¾ç”Ÿæ€çš„èƒœåˆ©ã€‚